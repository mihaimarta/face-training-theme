(this["webpackJsonpface-training-theme"]=this["webpackJsonpface-training-theme"]||[]).push([[0],{541:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(32),o=n.n(i),c=n(11),s=(n(514),n(635)),l=n(26),u=n(50),d=n(8),j=n(85),m=n.n(j),b=n(9),h=n(46),p=n(4),v=n(617),f=n(15),O=n(551),g=n(29),x=n(214),y=n.n(x),C=n(24),T=n(21),I=n(369),S=n.n(I),w=Object({NODE_ENV:"production",PUBLIC_URL:"https://vidispine.github.io/face-training-theme",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_TITLE:"Face Training Theme",REACT_APP_DOCUMENT_TITLE:"Face Training Theme"}).REACT_APP_VIDISPINE_URL,P=Object({NODE_ENV:"production",PUBLIC_URL:"https://vidispine.github.io/face-training-theme",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_TITLE:"Face Training Theme",REACT_APP_DOCUMENT_TITLE:"Face Training Theme"}).REACT_APP_APP_TITLE,k="^^PREFIX^^",D="^^SUFFIX^^",R="vcs_face_isTrainingMaterial",E="vcs_face_value",A="vcs_face_method",L="vcs_face_externalId",_="adu_face_DeepVAKeyframeAnalyzer",F="adu_av_valueId",N="adu_av_value",U="adu_av_confidence",M=n(1);function B(e){var t=e.subheader,n=e.IconComponent,a=void 0===n?S.a:n,r=Object(s.a)().t;return Object(M.jsxs)(T.a,{container:!0,alignItems:"center",children:[Object(M.jsx)(l.a,{pr:2,children:Object(M.jsx)(a,{color:"inherit"})}),Object(M.jsxs)(l.a,{children:[Object(M.jsx)(C.a,{variant:"h6",color:"inherit",children:P||r("appTitle")}),t&&Object(M.jsx)(C.a,{variant:"subtitle2",color:"inherit",children:t})]})]})}var V=n(265),q=n(174),W=n(383),z=n(373);V.a.use(z.a).use(W.a).use(q.e).init({debug:!1,fallbackLng:"en",whitelist:["en","sv","de"],supportedLngs:["en","sv","de"],interpolation:{escapeValue:!1},backend:{loadPath:"".concat("https://vidispine.github.io/face-training-theme","/locales/{{lng}}/{{ns}}.json")}});var G=V.a,H=n(10),J=n(5),K=n(33),Q=n(77),X=n(54),Y=n(49),$=n(232),Z=n(156),ee=n(65),te=n(553),ne=n(618),ae=n(31),re=n(47),ie=n(52),oe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"face";return J.j.createJob({queryParams:{type:"VCS_TRAINING_MERGE_ITEMS",jobmetadata:[{key:"itemId",value:e},{key:"targetItemId",value:t},{key:"modelType",value:n}]}})},ce=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"face";return new Promise((function(a,r){return J.j.createJob({queryParams:{type:"VCS_TRAINING_RELABEL_ITEM",jobmetadata:[{key:"itemId",value:e},{key:"newLabel",value:t},{key:"modelType",value:n}]}}).then((function(n){var i=Object(ae.a)(Object(ie.a)({},E,t));return J.i.updateItemMetadata({itemId:e,metadataDocument:i}).then((function(){return a(n)})).catch(r)})).catch(r)}))},se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a="item",r=window.localStorage.getItem("TRAINING_COLLECTION_ID"),i=n;i||(i=[]);var o=t;return o||(o=[]),Array.isArray(i)||(i=i.split(", ")),Array.isArray(o)||(o=o.split(", ")),i.includes(r)||o.push(r),o.length?new Promise((function(t,n){var c=o.map((function(t){return!i.includes(t)&&Object(d.m)(Object(b.a)({entityId:e,entityType:a,collectionId:t},r!==t&&{rootParentId:r}))})),s=i.map((function(t){return!o.includes(t)&&Object(d.o)({entityId:e,entityType:a,collectionId:t,rootParentId:r})}));Promise.all([].concat(Object(re.a)(c),Object(re.a)(s))).then(t).catch(n)})):Promise.resolve()};var le=n(45),ue=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,r=e.title,i=void 0===r?"Dialog":r,o=e.okText,c=void 0===o?"Ok":o,s=e.noText,l=void 0===s?"Cancel":s,u=e.message,d=void 0===u?"Message":u,j=e.Dialog,m=void 0===j?Q.a:j;return Object(M.jsxs)(m,{open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:i}),Object(M.jsx)(Y.a,{dividers:!0,children:d}),Object(M.jsxs)(ee.a,{children:[Object(M.jsx)(f.a,{onClick:n,children:l}),Object(M.jsx)(f.a,{variant:"contained",color:"primary",onClick:a,children:c})]})]})},de=function(e){var t=e.Dialog,n=void 0===t?ue:t,a=Object(le.a)(e,["Dialog"]);return Object(M.jsx)(n,Object(b.a)({},a))},je=r.a.createContext({}),me=function(e){var t=e.children,n=r.a.useState(!1),a=Object(H.a)(n,2),i=a[0],o=a[1],c=r.a.useState({}),s=Object(H.a)(c,2),l=s[0],u=l.config,d=l.resolve,j=l.reject,m=s[1],h=function(){m({}),o(!1)};return Object(M.jsxs)(je.Provider,{value:{openDialog:function(e){o(!0),m(e)}},children:[Object(M.jsx)(de,Object(b.a)(Object(b.a)({},u),{},{open:i,onSuccess:function(e){d(e),h()},onClose:function(e){j(e),h()}})),t]})},be=function(){var e=r.a.useContext(je).openDialog;return{showDialog:function(t){return new Promise((function(n,a){return e({config:t,resolve:n,reject:a})}))}}},he=r.a.createContext({resourceType:void 0,resourceListDocument:void 0}),pe=function(e){var t=e.children,n=e.resourceType,a=r.a.useState(),i=Object(H.a)(a,2),o=i[0],c=i[1];return r.a.useEffect((function(){J.o.listResourceType({resourceType:n}).then((function(e){var t=e.data;return c(t)}))}),[n]),Object(M.jsx)(he.Provider,{value:{resourceListDocument:o,resourceType:n},children:t})};function ve(){var e=r.a.useContext(he);if(void 0===e)throw new Error("getCognitiveResources must be used within a ResourceProvider");var t=e.resourceListDocument,n=(t=void 0===t?{}:t).resource;return{resource:(void 0===n?[]:n).filter((function(e){var t=e.vidinet,n=(t=void 0===t?{}:t).state,a=t.type;return"ONLINE"===n&&"COGNITIVE_SERVICE"===a}))}}var fe=n(565),Oe=n(233),ge=function(e){var t=e.open,n=e.message,a=e.severity,r=e.hideNotification;return Object(M.jsx)(fe.a,{open:t,autoHideDuration:2e3,onClose:r,children:Object(M.jsx)(Oe.a,{elevation:6,variant:"filled",severity:a,onClose:r,children:n})})},xe=Object(a.createContext)();function ye(e){var t=e.children,n=Object(a.useState)({open:!1,message:"",severity:""}),r=Object(H.a)(n,2),i=r[0],o=r[1],c=function(e,t){"clickaway"!==t&&o({open:!1,message:i.message,severity:i.severity})};return Object(M.jsxs)(xe.Provider,{value:{setNotification:o,hideNotification:c},children:[t,Object(M.jsx)(ge,{open:i.open,message:i.message,severity:i.severity,hideNotification:c})]})}function Ce(){var e=r.a.useContext(xe);if(void 0===e)throw new Error("useSnackbar must be used within a SnackbarProvider");return e}var Te=r.a.createContext(),Ie=function(e){var t,n=e.children,a=e.uploadProps,i=r.a.useState(null),o=Object(H.a)(i,2),c=o[0],s=o[1],l=Object(d.D)(Object(b.a)(Object(b.a)({},a),{},{initialMetadata:Object(ie.a)({},R,!1)})),u=l.onAddFiles,j=l.onChangeMetadata,m=l.onUpload,h=l.onRemoveFiles,p=l.onRemoveFile,v=l.files,f=Object(d.D)(Object(b.a)(Object(b.a)({},a),{},{initialMetadata:(t={},Object(ie.a)(t,R,!0),Object(ie.a)(t,E,""),t)})),O=f.onAddFiles,g=f.onChangeMetadata,x=f.onUpload,y=f.onRemoveFiles,C=f.onRemoveFile,T=f.files,I=function(e){return new Promise((function(t){u(e),t()})).then((function(){document.querySelector(".MuiListItem-root").click()}))},S=function(e){return new Promise((function(t){O(e),t()})).then((function(){document.querySelector(".MuiListItem-root").click()}))};return Object(M.jsx)(Te.Provider,{value:{useContentUploadFiles:function(){return{onAddFiles:I,onChangeMetadata:j,onUpload:m,onRemoveFiles:h,onRemoveFile:p,files:v}},useTrainingUploadFiles:function(){return{onAddFiles:S,onChangeMetadata:g,onUpload:x,onRemoveFiles:y,onRemoveFile:C,files:T}},uploadType:c,setUploadType:s},children:n})},Se=r.a.createContext({}),we=function(e){var t=e.children,n=Object(d.q)(J.d.searchCollection),a=n.request,i=n.data,o=void 0===i?{}:i,c=n.isLoading,s=n.isError;r.a.useEffect((function(){a({itemSearchDocument:{operator:{field:[{name:"vcs_face_isTrainingCollection",value:[{value:!0}]}],operation:"OR"}}})}),[a]);var l=r.a.useMemo((function(){if(c||s)return null;var e=o.collection,t=o.hits;if(!(void 0===t?0:t))return null;var n=Object(H.a)(e,1)[0].id;return window.localStorage.setItem("TRAINING_COLLECTION_ID",n),n}),[c,s,o]),u=Object(d.q)(J.o.listResourceType),j=u.request,m=u.data,b=u.isLoading,h=u.isError;r.a.useEffect((function(){j({resourceType:"callback"})}),[j]);var p=r.a.useMemo((function(){if(b||h)return null;var e=m.resource,t=void 0===e?[{}]:e,n=Object(H.a)(t,1)[0].id;return window.localStorage.setItem("CALLBACK_ID",n),n}),[b,h,m]),v=Object(d.q)(J.p.searchItemCollection),f=v.request,O=v.isLoading,g=v.isError;r.a.useEffect((function(){var e=[E,A,L],t=[R,"vcs_face_isTrainingCollection","vcs_face_isSampleCollection"],n={filter:[].concat(Object(re.a)(e.map((function(e){return{operation:"OR",field:[{name:e,value:[{value:"*"}]}]}}))),Object(re.a)(t.map((function(e){return{operation:"OR",field:[{name:e,value:[{value:!0}]}]}}))))};f({queryParams:{number:1},itemSearchDocument:n})}),[f]);var x=g||s||h,y=O||c||b,C=!y&&!x;return Object(M.jsx)(Se.Provider,{value:{trainingId:l,callbackId:p,isConfigured:C,isLoading:y,isError:x},children:t})},Pe=function(){var e=r.a.useContext(Se);if(void 0===e)throw new Error("useDialogContext must be used within a DialogProvider");return e},ke=function(e){var t=e.collectionDocument,n=e.setCollectionDocument,a=r.a.useMemo((function(){return Object(ae.f)(t.metadata,{flat:!0})}),[t]).title,i=void 0===a?"":a,o=r.a.useCallback((function(e){var t=e.target;return t.value?n({name:t.value,metadata:Object(ae.a)({title:t.value,vcs_face_isSampleCollection:!0})}):n({})}),[n]);return Object(M.jsx)(K.a,{value:i,required:!0,autoFocus:!0,margin:"dense",label:"New collection",type:"text",fullWidth:!0,onChange:o})},De=function(e){var t=e.open,n=e.onClose,a=e.item,i=void 0===a?{}:a,o=e.onSuccess,s=e.onError,l=void 0===s?function(){return null}:s,u=e.view,j=Pe().trainingId,m=i.itemId,b=i.parentId,h=r.a.useState(u||"search"),p=Object(H.a)(h,2),v=p[0],O=p[1],g=r.a.useState({}),x=Object(H.a)(g,2),y=x[0],C=x[1],T=r.a.useState([]),I=Object(H.a)(T,2),S=I[0],w=I[1],P=Object(d.A)({queryParams:{field:["collectionId","title"],content:"metadata"},rowsPerPage:5,itemSearchDocument:{filter:[{name:"collectionId",operation:"NOT",field:[{name:"collectionId",value:[{value:j}]}]}]}}),k=r.a.useMemo((function(){return"search"===v?S.length<1:"create"===v&&Object.keys(y).length<1}),[v,S,y]);return Object(M.jsxs)(Q.a,{open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:"Add to collection"}),Object(M.jsxs)(Y.a,{dividers:!0,children:[Object(M.jsxs)($.a,{value:v,onChange:function(e,t){return t&&O(t)},variant:"fullWidth",textColor:"primary",indicatorColor:"primary",style:{marginBottom:"10px"},children:[Object(M.jsx)(Z.a,{disabled:void 0!==u,value:"search",label:"Search",icon:Object(M.jsx)(te.a,{})}),Object(M.jsx)(Z.a,{disabled:void 0!==u,value:"create",label:"Create",icon:Object(M.jsx)(ne.a,{})})]}),{search:Object(M.jsx)(c.d,{onChange:w,CollectionTableProps:{selected:S,onRowClick:function(e){var t=e.id;return w([t])}},searchProps:P}),create:Object(M.jsx)(ke,{collectionDocument:y,setCollectionDocument:C})}[v]]}),Object(M.jsx)(ee.a,{children:Object(M.jsx)(f.a,{onClick:function(){var e=Object(H.a)(S,1)[0];"create"===v&&function(e){return J.d.createCollection({collectionDocument:e})}(y).then((function(e){var t=e.data.id;return se(m,t,b).then(o).catch(l)})).catch(l),"search"===v&&se(m,e,b).then(o).catch(l).finally(n)},color:"primary",variant:"contained",disabled:k,children:"Add"})})]})},Re=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,r=e.onError,i=e.itemId;return Object(M.jsxs)(Q.a,{fullWidth:!0,open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:"Add new resource"}),Object(M.jsx)(Y.a,{dividers:!0,children:Object(M.jsx)(c.N,{uploadProps:{onUploadFile:function(e){var t=e.file;return J.q.createShapeImportRaw({itemId:i,file:t,queryParams:{tag:[R]}}).then(a).catch(r)}},allowUploadToCollection:!1,UploadListItemProps:{onClick:function(){return null}}})})]})},Ee=n(104),Ae=n.n(Ee),Le=n(374),_e=n.n(Le),Fe=(n(521),n(136)),Ne=n(619),Ue=n(620),Me={options:[{label:"ID",value:"itemId"},{label:"Name",value:E},{label:"Type",value:"type"}]},Be=function(e){var t=e.filename,n=e.setFilename,a=e.collectionId,r=e.setCollectionId,i=Pe().trainingId,o=Object(d.A)({queryParams:{field:["collectionId","title"],content:"metadata"},rowsPerPage:5,itemSearchDocument:{filter:[{name:"collectionId",operation:"NOT",field:[{name:"collectionId",value:[{value:i}]}]}]}});return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(C.a,{variant:"h6",children:"Who is this?"}),Object(M.jsx)(c.L,{autoFocus:!0,label:"Name of person",input:{onChange:function(e){var t=e.target;return n(t.value)},value:t}}),Object(M.jsxs)(l.a,{mt:1,children:[Object(M.jsx)(C.a,{paragraph:!0,variant:"subtitle2",children:"* Adding this resource to a collection is optional"}),Object(M.jsx)(c.d,{CollectionTableProps:{onRowClick:function(e){var t=e.id;return r(a.includes(t)?[]:[t])},selected:a},searchProps:o,searchPlaceholder:"Search collections..."})]})]})},Ve=function(e){var t=e.itemId,n=e.params,a=void 0===n?{view:"search",selected:[],filename:"",collectionId:[]}:n,i=e.setParams,o=void 0===i?function(){return null}:i,s=e.allowCreate,l=void 0!==s&&s,u=r.a.useState({itemSearchDocument:{filter:[{name:"training_material",operation:"AND",field:[{name:R,value:[{value:!0}]}]},{name:"itemId",operation:"NOT",field:[{name:"itemId",value:[{value:t}]}]}]},queryParams:{field:[E,"itemId"],content:"metadata"},rowsPerPage:5}),j=Object(H.a)(u,1)[0];return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)($.a,{value:a.view,onChange:function(e,t){return t&&(n=t,o(Object(b.a)(Object(b.a)({},a),{},{view:n})));var n},variant:"fullWidth",textColor:"primary",indicatorColor:"primary",style:{marginBottom:"10px"},children:[Object(M.jsx)(Z.a,{value:"search",label:"Search for face",icon:Object(M.jsx)(te.a,{})}),Object(M.jsx)(Z.a,{disabled:!l,value:"create",label:"Create new face",icon:Object(M.jsx)(Ne.a,{})})]}),{search:Object(M.jsx)(c.p,{ItemTableProps:Object(b.a)({onRowClick:function(e){var t=e.id,n=e.metadata,r=[];if(!a.selected.some((function(e){return e.id===t}))){var i=Object(ae.f)(n,{flat:!0,arrayOnSingle:!1})[E];r.push({title:i,id:t})}o(Object(b.a)(Object(b.a)({},a),{},{selected:r}))},selected:a.selected.map((function(e){return e.id}))},Me),searchProps:Object(d.A)(j),searchPlaceholder:"Search faces..."}),create:Object(M.jsx)(Be,{filename:a.filename,setFilename:function(e){return o(Object(b.a)(Object(b.a)({},a),{},{filename:e}))},collectionId:a.collectionId,setCollectionId:function(e){return o(Object(b.a)(Object(b.a)({},a),{},{collectionId:e}))}})}[a.view]]})},qe=Object(p.a)((function(e){return{root:{backgroundColor:e.palette.background.default}}}))(c.B),We=function(e){var t=e.itemType,n=void 0===t?{}:t;return Object(M.jsx)(qe,{innerProps:{itemType:n}})},ze=function(e){var t=e.open,n=e.onClose,a=e.item,i=e.onSuccess,o=e.onError,c=void 0===o?function(){return null}:o,s=e.allowCreate,u=void 0!==s&&s,j=a.itemId,m=a.title,b=a.parentId,h=r.a.useState({view:"search",selected:[],filename:"",collectionId:[]}),p=Object(H.a)(h,2),v=p[0],O=p[1],g=v.view,x=v.selected,y=v.filename,T=v.collectionId,I=r.a.useMemo((function(){return"search"===g?x.length<1:"create"!==g||y.length<1}),[g,x,y]),S=r.a.useMemo((function(){var e=Object(H.a)(v.selected,1)[0],t=void 0===e?{}:e,n=t.title,a=t.id;return"".concat(n," (").concat(a,")")}),[v.selected]);return Object(M.jsxs)(Q.a,{open:t,fullWidth:!0,maxWidth:"sm",onClose:n,children:[Object(M.jsxs)(X.a,{children:["Map resource (",m,")"]}),Object(M.jsxs)(Y.a,{dividers:!0,children:[Object(M.jsx)(d.e,{itemId:j,queryParams:{content:["thumbnail"],"noauth-url":!0},children:Object(M.jsx)(We,{})}),Object(M.jsx)(Ve,{itemId:j,params:v,setParams:O,allowCreate:u})]}),Object(M.jsxs)(ee.a,{children:[Object(M.jsx)(l.a,{display:"flex",alignItems:"center",justifyContent:"space-between",width:1,children:Object(M.jsx)(l.a,{px:2,flexGrow:1,display:"flex",alignItems:"center",children:"search"===g&&v.selected.length>0&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(Ue.a,{style:{marginRight:8}}),Object(M.jsxs)(C.a,{variant:"body2",children:["This action will move the contents and references of\xa0",Object(M.jsx)(C.a,{variant:"button",children:"".concat(m," (").concat(j,")")}),"\xa0to\xa0",Object(M.jsx)(C.a,{variant:"button",children:S})]})]})})}),Object(M.jsx)(f.a,{style:{flexShrink:0},onClick:function(){if("search"===g){var e=Object(H.a)(v.selected,1)[0].id;if(!e)return;oe(j,e).then(i).catch(c)}if("create"===g){var t=Object(H.a)(T,1)[0];se(j,t,b).then((function(){return ce(j,y).then(i).catch(c)})).catch(c)}},color:"primary",variant:"contained",disabled:I,children:"create"===g?"Create item":"Map resource"})]})]})},Ge=n(387);function He(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}var Je=["__mp3_160k"],Ke=["__mp4"],Qe=["__png"],Xe=["application/mxf"],Ye=[],$e=[],Ze=function(e){if(!e||!e.type)return[];var t=e.type.toLowerCase();return t.startsWith("audio")||$e.includes(t)?Je:t.startsWith("video")||Xe.includes(t)?Ke:t.startsWith("image")||Ye.includes(t)?Qe:[]},et=function(e){var t=e.file,n=e.collectionId,a=e.onProgress,r=e.metadata,i=void 0===r?{}:r,o=e.placeholderParams,c=void 0===o?{}:o,s=e.importParams,l=void 0===s?{}:s,u=e.chunkedUploadProps,d=void 0===u?{}:u,j=e.generateTransferId,m=void 0===j?He:j,h=e.getShapeTags,p=void 0===h?Ze:h;return new Promise((function(e,r){try{var o,s,u=window.localStorage.getItem("TRAINING_COLLECTION_ID");a({});var j=p(t),h=i[R],v=i[E],f=Object(le.a)(i,[R,E].map(Ge.a)),O=t.type,g=O.split("/"),x=Object(H.a)(g,1)[0],y=Object(b.a)(Object(b.a)({mimeType:O,mediaType:x},f),h&&(o={},Object(ie.a)(o,R,!0),Object(ie.a)(o,E,v),o)),C=Object(ae.a)(y);J.z.createImportPlaceholder({metadataDocument:C,queryParams:Object(b.a)({container:1},c)}).then((function(e){var t=e.data;s=t.id;var a=[];return n&&(Array.isArray(n)?a=a.concat(n):a.push(n)),h&&a.push(u),a.length?Promise.all(a.map((function(e){return J.d.addCollectionEntity({collectionId:e,entityId:s})}))):Promise.resolve()})).then((function(){var e=m(),n=Object(b.a)(Object(b.a)({transferId:e,tag:j},h&&{noTranscode:!0,tag:[R],original:R}),l);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,a){new J.a(e,Object(b.a)({onFail:function(e){return a(e)},onComplete:function(e){return n(e)}},t)).upload()}))}(t,Object(b.a)({api:{method:J.z.createImportComponentRaw,props:{itemId:s,component:"container",queryParams:n}},onProgress:a},d))})).then((function(t){e(Object(b.a)(Object(b.a)({},t),{},{itemId:s,collectionId:n}))})).catch((function(e){return r(e)}))}catch(T){console.error(T),r(T)}}))};function tt(e,t){for(var n=e.split(",").pop(),a=atob(n),r=new ArrayBuffer(a.length),i=new Uint8Array(r),o=0;o<a.length;o+=1)i[o]=a.charCodeAt(o);return new File([i],t,{type:"image/jpeg"})}var nt=function(e){var t=e.src,n=e.filename,a=e.onCrop,i=r.a.createRef(),o=r.a.useState({}),c=Object(H.a)(o,2),s=c[0],l=c[1];return Object(M.jsx)(_e.a,{ref:i,src:t,crop:s,onChange:function(e){return l(e)},onComplete:function(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ae()().toISOString();return new Promise((function(a,r){var i=t.current;i||r(new Error("No image found"));var o=i.imageRef;o||r(new Error("No image found"));var c=o.current;c||r(new Error("No image found"));var s=c.naturalWidth,l=c.naturalHeight,u=e.x/100*s,d=e.y/100*l,j=e.width/100*s,m=e.height/100*l,b=document.createElement("canvas"),h=b.getContext("2d");b.width=j,b.height=m;try{h.drawImage(c,u,d,j,m,0,0,j,m)}catch(p){r(p)}a(tt(b.toDataURL("image/jpeg"),n))}))}(t,i,n).then(a).catch((function(){return null}))},onImageLoaded:function(e){var t=e.src;return URL.revokeObjectURL(t)}})},at={view:"search",selected:[],filename:"",collectionId:[]},rt=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,i=e.onError,o=r.a.useState(null),c=Object(H.a)(o,2),s=c[0],l=c[1],u=r.a.useState(null),d=Object(H.a)(u,2),j=d[0],m=d[1],b=r.a.useState(!1),h=Object(H.a)(b,2),p=h[0],v=h[1],O=r.a.useState(at),g=Object(H.a)(O,2),x=g[0],y=g[1];r.a.useEffect((function(){var e;t&&(e=document.querySelector("video"),new Promise((function(t,n){var a=document.createElement("canvas"),r=a.getContext("2d"),i=e.videoWidth,o=e.videoHeight;a.width=i,a.height=o;try{r.drawImage(e,0,0,i,o)}catch(s){var c=s.message;n(c)}a.toBlob((function(e){try{var a=URL.createObjectURL(e);t(a)}catch(i){var r=i.message;n(r)}}))}))).then(l),t||URL.revokeObjectURL(s)}),[t]);var T=r.a.useMemo((function(){return!!p||("create"===x.view?x.filename.length<1:"search"===x.view&&x.selected.length<1)}),[p,x]);return Object(M.jsxs)(Q.a,{open:t,onClose:n,children:[Object(M.jsxs)(X.a,{disableTypography:!0,children:[Object(M.jsx)(C.a,{variant:"h6",children:"Capture face"}),Object(M.jsx)(C.a,{variant:"body2",children:"Make a selection by clicking and dragging the pointer over the image."}),Object(M.jsx)(C.a,{variant:"body2",children:"You may either add it to an existing resource or create a new face."})]}),Object(M.jsxs)(Y.a,{dividers:!0,children:[s&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(nt,{src:s,onCrop:m}),Object(M.jsx)(Ve,{allowCreate:!0,params:x,setParams:y})]}),!s&&Object(M.jsx)(Fe.a,{})]}),Object(M.jsxs)(ee.a,{children:[Object(M.jsx)(f.a,{onClick:n,children:"Cancel"}),Object(M.jsx)(f.a,{disabled:T,variant:"contained",color:"primary",onClick:function(){var e=function(){return v(!p)},t=x.view,n=x.selected,r=x.filename,o=x.collectionId;if("search"===t){var c=Object(H.a)(n,1)[0].id,s={tag:[R],noTranscode:!0,createThumbnails:!0};return e(),J.q.createShapeImportRaw({itemId:c,file:j,queryParams:s}).then(a).catch(i)}if("create"===t){var l,u=o,d=(l={},Object(ie.a)(l,E,r),Object(ie.a)(l,R,!0),l);return et({file:j,metadata:d,collectionId:u,onProgress:e}).then(a).catch(i)}return null},children:"Add face"})]})]})},it=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,i=e.onError,o=void 0===i?function(){return null}:i,c=r.a.useState(""),s=Object(H.a)(c,2),l=s[0],u=s[1],d=r.a.useMemo((function(){return l.length<1}),[l]);return Object(M.jsxs)(Q.a,{open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:"Create collection"}),Object(M.jsx)(Y.a,{dividers:!0,children:Object(M.jsx)(K.a,{value:l,required:!0,autoFocus:!0,margin:"dense",label:"New collection",type:"text",fullWidth:!0,onChange:function(e){var t=e.target;return u(t.value)}})}),Object(M.jsx)(ee.a,{children:Object(M.jsx)(f.a,{onClick:function(){if(l){var e={name:l,metadata:Object(ae.a)({title:l,vcs_face_isSampleCollection:!0})};J.d.createCollection({collectionDocument:e}).then((function(e){var t=e.data,n=(t=void 0===t?{}:t).id;return a(n)})).catch(o)}},color:"primary",variant:"contained",disabled:d,children:"Add"})})]})},ot={options:[{label:"ID",value:"itemId"},{label:"Name",value:E},{label:"Type",value:"type"}]},ct={itemSearchDocument:{filter:[{name:"training_material",operation:"AND",field:[{name:R,value:[{value:!0}]}]}]},queryParams:{field:[E,"itemId"],content:"metadata"},rowsPerPage:5},st=function(e){var t=e.open,n=e.onClose,a=e.shapeId,i=e.itemId,o=e.onSuccess,s=e.onError,l=void 0===s?function(){return null}:s,u=r.a.useState("search"),j=Object(H.a)(u,2),m=j[0],h=j[1],p=r.a.useState([]),v=Object(H.a)(p,2),O=v[0],g=v[1],x=r.a.useMemo((function(){return[0===O.length,O.length?O[0]:void 0]}),[O]),y=Object(H.a)(x,2),C=y[0],T=y[1];return Object(M.jsxs)(Q.a,{open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:"Move resource"}),Object(M.jsxs)(Y.a,{dividers:!0,children:[Object(M.jsxs)($.a,{value:m,onChange:function(e,t){return t&&h(t)},variant:"fullWidth",textColor:"primary",indicatorColor:"primary",style:{marginBottom:"10px"},children:[Object(M.jsx)(Z.a,{value:"search",label:"Search",icon:Object(M.jsx)(te.a,{})}),Object(M.jsx)(Z.a,{disabled:!0,value:"create",label:"Create",icon:Object(M.jsx)(ne.a,{})})]}),{search:Object(M.jsx)(c.p,{ItemTableProps:Object(b.a)({onRowClick:function(e){var t=e.id,n=e.metadata,a=[];if(!O.some((function(e){return e.id===t}))){var r=Object(ae.f)(n,{flat:!0,arrayOnSingle:!1})[E];a.push({title:r,id:t})}g(a)},selected:O.map((function(e){return e.id}))},ot),searchProps:Object(d.A)(ct)}),create:null}[m]]}),Object(M.jsx)(ee.a,{children:Object(M.jsx)(f.a,{onClick:function(){return function(e,t,n){return new Promise((function(a,r){J.q.getShape({itemId:t,shapeId:e}).then((function(i){var o=i.data;return J.q.createShape({itemId:n,shapeDocument:o}).then((function(n){var i=n.data.id;return J.q.removeShape({itemId:t,shapeId:e}).then((function(){return a(i)})).catch(r)})).catch(r)})).catch(r)}))}(a,i,T.id).then(o).catch(l)},color:"primary",variant:"contained",disabled:C,children:T?"Move to ".concat(T.title):"Move"})})]})},lt=function(e){var t=e.item,n=(t=void 0===t?{}:t).itemId,a=t.title,i=e.open,o=e.onClose,c=e.onSuccess,s=e.onError,l=void 0===s?function(){return null}:s,u=r.a.useState(a),d=Object(H.a)(u,2),j=d[0],m=d[1],b=r.a.useMemo((function(){return j===a}),[j,a]);return Object(M.jsxs)(Q.a,{open:i,onClose:o,children:[Object(M.jsx)(X.a,{children:"Rename resource"}),Object(M.jsx)(Y.a,{dividers:!0,children:Object(M.jsx)(K.a,{value:j,required:!0,autoFocus:!0,margin:"dense",label:"Name",type:"text",fullWidth:!0,onChange:function(e){var t=e.target;return m(t.value)}})}),Object(M.jsx)(ee.a,{children:Object(M.jsx)(f.a,{onClick:function(){j&&ce(n,j).then(c).catch(l)},color:"primary",variant:"contained",disabled:b,children:"Save"})})]})},ut=n(60),dt=n(390),jt=n(76),mt=n(277),bt=n(269),ht=function(e){var t=e.collectionId,n=e.resourceId,a=e.callbackId,r=Object(le.a)(e,["collectionId","resourceId","callbackId"]),i=J.x.vFetch,o="/API/collection/".concat(t,"/train"),c={resourceId:n,callbackId:a};return i(Object(b.a)({path:o,method:"POST",queryParams:c,body:{}},r))};var pt=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,i=e.onError,o=e.resourceList,c=void 0===o?[]:o,s=Pe(),u=s.callbackId,d=s.trainingId,j=r.a.useState(),m=Object(H.a)(j,2),h=m[0],p=m[1],v=r.a.useRef(),O=r.a.useState(""),g=Object(H.a)(O,2),x=g[0],y=g[1];return r.a.useEffect((function(){return v.current={},Promise.all(c.map((function(e){var t=e.id;return ht({collectionId:d,analyzeJobDocument:{},queryParams:{resourceId:t,callbackId:u},costEstimate:!0})}))).then((function(e){return Promise.all(e.map((function(e){var t=e.data.id;return new Promise((function(e,n){!function a(){J.y.getCostEstimate({costEstimateId:t}).then((function(n){null!==v.current[t]&&(clearTimeout(v.current[t]),delete v.current[t]);var r=n.data;"FINISHED"===(r=void 0===r?{}:r).state?e(n):v.current[t]=setTimeout((function(){return a()}),1e3)})).catch((function(e){return n(e)}))}()}))})))})).then((function(e){var t=e.reduce((function(e,t){var n=t.data.service,a=void 0===n?[]:n,r=Object(H.a)(a,1)[0],i=r.cost,o=r.resource;return Object(b.a)(Object(b.a)({},e),{},Object(ie.a)({},o,i))}),{});p(t)})).catch((function(){return p({})})),function(){null!==v.current&&Object.values(v.current).forEach((function(e){return clearTimeout(e)}))}}),[]),Object(M.jsxs)(Q.a,{open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:"Train collection"}),Object(M.jsx)(Y.a,{dividers:!0,children:c.length>0?Object(M.jsx)(ut.a,{children:Object(M.jsx)(dt.a,{value:x,onChange:function(e){y(e.target.value)},children:c.map((function(e){var t=e.id,n=e.vidinet;return Object(M.jsx)(jt.a,{value:t,disabled:!h||void 0===h[t],control:Object(M.jsx)(mt.a,{}),label:"".concat(n?n.name:t).concat(h&&h[t]?" - $".concat(h[t].value.toFixed(2)):"")},t)}))})}):Object(M.jsx)(C.a,{children:"No VCS resources available."})}),Object(M.jsx)(l.a,{height:4,width:"100%",children:void 0===h&&Object(M.jsx)(bt.a,{variant:"query"})}),Object(M.jsxs)(ee.a,{children:[Object(M.jsx)(f.a,{onClick:n,children:"Close"}),Object(M.jsx)(f.a,{variant:"contained",color:"primary",onClick:function(){return ht({collectionId:d,analyzeJobDocument:{},queryParams:{resourceId:x,callbackId:u}}).then(a).catch(i)},disabled:""===x,children:"Start"})]})]})},vt=Object(p.a)((function(e){return{root:Object(b.a)(Object(b.a)({},e.typography.h6),{},{textTransform:"none",opacity:.8,paddingLeft:0,marginRight:20,"&::after":{color:e.palette.primary.main,transition:"width 0.25s ease-in-out 0.05s",borderBottom:"0.25em solid",width:0,position:"absolute",bottom:0,left:0,content:'""'},"&:hover, &.selected":{opacity:1,backgroundColor:"unset","&::after":{width:"calc(100% - 8px)"}}})}}),{name:"VdtHeaderButtonLink"})(f.a);function ft(e){var t=e.userName,n=e.serverUrl,a=e.onLogout,i=Object(s.a)().t,o=Object(v.a)((function(e){return e.breakpoints.down("sm")})),u=be().showDialog,d=Ce().setNotification,j=ve().resource,m=void 0===j?[]:j,b=r.a.useMemo((function(){return window.location.href.split("server")[0]}),[]),p=Object(c.P)(),x=p.togglePalette,C=p.isDefaultPalette;return Object(M.jsx)(O.a,{position:"relative",children:Object(M.jsxs)(l.a,{px:2,py:.5,bgcolor:"#20232a",color:"common.white",width:"100%",display:"grid",gridTemplateColumns:o?"1fr auto":"auto 1fr auto",children:[Object(M.jsx)(l.a,{gridRow:o?"1":"initial",children:Object(M.jsx)(B,{subheader:n})}),Object(M.jsxs)(l.a,{display:"flex",justifyContent:"center",alignItems:"center",gridColumn:o?"1 / span 2":"initial",children:[Object(M.jsx)(vt,{activeClassName:"selected",variant:"text",component:h.c,to:"/import/",color:"inherit",disableRipple:!0,children:i("upload")}),Object(M.jsx)(vt,{activeClassName:"selected",variant:"text",component:h.c,to:"/item/",color:"inherit",disableRipple:!0,children:i("Content")}),Object(M.jsx)(vt,{activeClassName:"selected",variant:"text",component:h.c,to:"/training/",color:"inherit",disableRipple:!0,children:i("Faces")}),Object(M.jsx)(f.a,{startIcon:Object(M.jsx)(y.a,{}),onClick:function(){return u({Dialog:pt,resourceList:m}).then((function(){return d({open:!0,message:"Training started"})})).catch((function(e){var t=e.message;return t&&d({open:!0,message:t,severity:"error"})}))},variant:"contained",color:"primary",disableRipple:!0,children:i("Train faces")})]}),Object(M.jsx)(l.a,{display:"flex",justifyContent:"flex-end",gridRow:o?"1":"initial",children:Object(M.jsx)(c.O,{userName:t,onLogout:a,togglePalette:function(){return x()},isDefaultPalette:C,locale:{set:function(e){return t=e,G.changeLanguage(t);var t},curr:G.language||"",options:[{label:"Svenska",value:"sv"},{label:"English",value:"en"},{label:"Deutsch",value:"de"}]},children:!w&&n&&Object(M.jsx)(g.a,{component:"a",href:b,children:i("Switch Server")})})})]})})}var Ot=n(28),gt=n(61),xt=n(57),yt=n(70),Ct=n.n(yt);function Tt(e){var t=e.icon,n=void 0===t?Ct.a:t,a=e.children,i=e.onOpen,o=void 0===i?function(){return null}:i,c=Object(le.a)(e,["icon","children","onOpen"]),s=r.a.useState(null),l=Object(H.a)(s,2),u=l[0],d=l[1],j=function(e){e.stopPropagation(),d(null)};return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(Ot.a,{component:xt.a,onClick:function(e){e.stopPropagation(),o(e),d(e.currentTarget)},disableRipple:!0,children:Object(M.jsx)(n,Object(b.a)({},c))}),Object(M.jsx)(gt.a,{onClick:j,anchorEl:u,keepMounted:!0,open:Boolean(u),onClose:j,elevation:1,PaperProps:{square:!0},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:a})]})}var It=n(56),St=n(30),wt=n(48),Pt=n(229),kt=n(230),Dt=n(274),Rt=n(621),Et=n(622),At=n(554),Lt=n(623),_t=n(624),Ft=n(117),Nt=n(179);var Ut=function(e){var t=e.open,n=e.onClose,a=e.itemId,i=Pe().callbackId,o=ve().resource,c=void 0===o?[]:o,s=r.a.useState(),u=Object(H.a)(s,2),d=u[0],j=u[1],m=r.a.useRef(),h=r.a.useState(""),p=Object(H.a)(h,2),v=p[0],O=p[1];return r.a.useEffect((function(){return m.current={},Promise.all(c.map((function(e){var t=e.id;return J.i.createItemAnalyze({itemId:a,analyzeJobDocument:{},queryParams:Object(b.a)({resourceId:t,jobmetadata:[{key:"cognitive_service_KeyframeInterval",value:1}]},i&&{callbackId:i}),costEstimate:!0})}))).then((function(e){return Promise.all(e.map((function(e){var t=e.data.id;return new Promise((function(e,n){!function a(){J.y.getCostEstimate({costEstimateId:t}).then((function(n){null!==m.current[t]&&(clearTimeout(m.current[t]),delete m.current[t]);var r=n.data;"FINISHED"===(r=void 0===r?{}:r).state?e(n):m.current[t]=setTimeout((function(){return a()}),1e3)})).catch((function(e){return n(e)}))}()}))})))})).then((function(e){var t=e.reduce((function(e,t){var n=t.data.service,a=void 0===n?[]:n,r=Object(H.a)(a,1)[0],i=r.cost,o=r.resource;return Object(b.a)(Object(b.a)({},e),{},Object(ie.a)({},o,i))}),{});j(t)})).catch((function(){return j({})})),function(){null!==m.current&&Object.values(m.current).forEach((function(e){return clearTimeout(e)}))}}),[a]),Object(M.jsxs)(Q.a,{open:t,onClose:n,children:[Object(M.jsx)(X.a,{children:"Analyze"}),Object(M.jsx)(wt.a,{}),Object(M.jsx)(Y.a,{children:c.length>0?Object(M.jsxs)(ut.a,{children:[Object(M.jsx)(Nt.a,{children:"Choose Cognitive Service"}),Object(M.jsx)(dt.a,{value:v,onChange:function(e){O(e.target.value)},children:c.map((function(e){var t=e.id,n=e.vidinet;return Object(M.jsx)(jt.a,{value:t,control:Object(M.jsx)(mt.a,{}),label:"".concat(n?n.name:t).concat(d&&d[t]?" - $".concat(d[t].value.toFixed(2)):"")},t)}))})]}):Object(M.jsx)(C.a,{children:"No VCS resources available."})}),Object(M.jsx)(l.a,{height:4,width:"100%",children:void 0===d?Object(M.jsx)(bt.a,{variant:"query"}):Object(M.jsx)(wt.a,{})}),Object(M.jsxs)(ee.a,{children:[Object(M.jsx)(f.a,{onClick:n,children:"Close"}),Object(M.jsx)(f.a,{variant:"contained",color:"primary",onClick:function(){return J.i.createItemAnalyze({itemId:a,analyzeJobDocument:{},queryParams:Object(b.a)({resourceId:v,jobmetadata:[{key:"cognitive_service_KeyframeInterval",value:1}]},i&&{callbackId:i})}).then((function(){return n()}))},disabled:""===v,children:"Start"})]})]})};function Mt(e){var t=e.mediaType,n=e.itemId,a=e.onCapture,r=Object(u.g)(),i=Ce().setNotification,o=Pe().isConfigured,s=be().showDialog;return Object(M.jsxs)(Tt,{children:[Object(M.jsxs)(g.a,{onClick:function(){return s({Dialog:Ut,itemId:n}).catch((function(){return null}))},disabled:"video"!==t,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(Rt.a,{})}),Object(M.jsx)(St.a,{primary:"Analyze"})]}),Object(M.jsxs)(g.a,{onClick:a,disabled:"video"!==t||!o,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(Et.a,{})}),Object(M.jsx)(St.a,{primary:"Capture face"})]}),Object(M.jsx)(wt.a,{}),Object(M.jsxs)(g.a,{onClick:function(){return s({Dialog:c.i,entity:"item",entityId:n,confirmButtonText:"Permanently delete item"}).then((function(){i({open:!0,message:"".concat(n," successfully removed")}),r.push("/item/")})).catch((function(e){var t=e.message;return t&&i({open:!0,message:t,severity:"error"})}))},children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(At.a,{})}),Object(M.jsx)(St.a,{primary:"Delete",primaryTypographyProps:{color:"secondary"}})]})]})}function Bt(e){var t=e.itemType,n=void 0===t?{}:t,a=e.isLoading,i=e.onClose,o=e.linkTo,l=e.onCapture,u=Object(s.a)().t,j=n.metadata,m=n.shape,b=void 0===m?[]:m,p=n.id,v=r.a.useMemo((function(){return Object(ae.f)(j,{joinValue:",",flat:!0})}),[j]),f=Object(H.a)(b,1)[0],O=v.title,g=v.mimeType,x=v.created,y=v.user,I=v.originalFilename,S=v.mediaType;return Object(M.jsxs)(Pt.a,{square:!0,elevation:0,style:{backgroundColor:"inherit"},children:[Object(M.jsx)(kt.a,{title:a?Object(M.jsx)(Ft.a,{variant:"rect",width:"50%",height:28}):O||I,avatar:a?Object(M.jsx)(Ft.a,{variant:"rect",width:40,height:40}):Object(M.jsx)(c.z,{avatar:g}),titleTypographyProps:{variant:"h5"},action:Object(M.jsxs)(M.Fragment,{children:[o&&Object(M.jsx)(Ot.a,{component:h.b,to:o,disableRipple:!0,children:Object(M.jsx)(Lt.a,{})}),Object(M.jsx)(d.f,{roleName:[ae.i.ITEM_WRITE],allow:Object(M.jsx)(Mt,{onCapture:l,itemId:p,mediaType:S})}),i&&Object(M.jsx)(Ot.a,{component:xt.a,onClick:i,disableRipple:!0,children:Object(M.jsx)(_t.a,{})})]})}),Object(M.jsx)(Dt.a,{children:a?Object(M.jsx)(Ft.a,{variant:"rect",width:"10%",height:18}):Object(M.jsxs)(T.a,{container:!0,alignItems:"center",justifyContent:"space-between",children:[Object(M.jsx)(T.a,{item:!0,children:a?Object(M.jsx)(Ft.a,{variant:"rect",width:"10%",height:18}):Object(M.jsxs)(T.a,{container:!0,alignItems:"center",children:[Object(M.jsxs)(C.a,{variant:"body2",children:[u("createdBy"),"\xa0"]}),Object(M.jsx)(C.a,{variant:"subtitle2",children:y}),Object(M.jsx)(C.a,{variant:"body2",children:"\xa0on\xa0"}),Object(M.jsx)(C.a,{variant:"subtitle2",children:x?Ae()(x).format("ll"):""})]})}),Object(M.jsx)(T.a,{item:!0,children:a?Object(M.jsx)(Ft.a,{variant:"rect",width:"10%",height:18}):Object(M.jsx)(T.a,{container:!0,alignItems:"center",children:Object(M.jsx)(c.x,{shapeType:f})})})]})})]})}var Vt=n(399),qt=n(385),Wt=n(3),zt=n(278),Gt=n(91),Ht=n(625),Jt=Object(p.a)((function(e){return{root:{height:e.spacing(4),borderRadius:e.spacing(4),paddingRight:e.spacing(1),"&:hover":{backgroundColor:"".concat(e.palette.secondary.light,"4d !important")}},avatar:{height:"".concat(e.spacing(3),"px !important"),width:"".concat(e.spacing(3),"px !important")},deleteIcon:{width:"auto !important"},disabled:{opacity:"1 !important"}}}))(zt.a),Kt=Object(p.a)((function(e){var t=e.palette;return{root:{cursor:"pointer",transition:"background-color 0.3s ease-out","&:hover":{backgroundColor:"light"===t.type?"rgba(0, 0, 0, 0.1)":"rgba(0, 0, 0, 0.2)"}},isActive:{backgroundColor:"light"===t.type?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.3)","&:hover":{backgroundColor:"light"===t.type?"rgba(0, 0, 0, 0.3)":"rgba(0, 0, 0, 0.4)"}}}}))((function(e){var t=e.start,n=e.end,a=e.metadata,i=e.classes,o=e.onSeek,c=e.isActive,s=e.onClick,u=r.a.createRef(),d=r.a.useMemo((function(){return a.find((function(e){return e.name===_})).group.map((function(e){var t=e.adu_av_value,n=void 0===t?"":t,a=e.adu_av_valueId,r=e.adu_av_confidence,i=e.group;return{unknown:n.includes("unknown_"),confidence:r,value:n,id:a,box:i}}))}),[a]),j=r.a.useMemo((function(){var e=Object(ae.c)(t),a=Object(ae.c)(n),r={samples:a.samples-e.samples,timeBase:a.timeBase};return{startText:e,endText:a,durationText:Object(ae.d)(r)}}),[n,t]),m=j.startText,b=j.endText,h=j.durationText;r.a.useEffect((function(){c&&u&&u.current&&u.current.scrollIntoView({behavior:"smooth",block:"nearest"})}),[c]);var p=function(e,t){e.stopPropagation(),s(t)};return Object(M.jsxs)(l.a,{children:[Object(M.jsx)(l.a,{minHeight:50,p:2,ref:u,onClick:function(){return o(m.toSeconds())},className:Object(Wt.a)(i.root,Object(ie.a)({},i.isActive,c)),children:Object(M.jsxs)(T.a,{container:!0,alignItems:"flex-start",wrap:"nowrap",children:[Object(M.jsx)(T.a,{item:!0,children:Object(M.jsxs)(T.a,{container:!0,direction:"column",children:[Object(M.jsx)(C.a,{variant:"caption",children:m.toSmpte()}),Object(M.jsx)(C.a,{variant:"caption",children:b.toSmpte()})]})}),Object(M.jsx)(T.a,{item:!0,style:{flexGrow:1},children:Object(M.jsx)(l.a,{px:2,children:d.map((function(e){var t=e.id,n=e.value,a=e.unknown,r=e.confidence;return Object(M.jsx)(Gt.a,{title:"I know this person, click to edit",placement:"top-start",children:Object(M.jsx)(Jt,{label:n,variant:"outlined",size:"small",clickable:!0,disabled:!a,onClick:function(e){return p(e,t)},onDelete:function(){return null},avatar:a?Object(M.jsx)(Ht.a,{}):null,deleteIcon:Object(M.jsx)("span",{children:Math.round(100*r)})},t)},t)}))})}),Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(T.a,{container:!0,direction:"column",children:Object(M.jsx)(C.a,{variant:"caption",children:h.toDuration()})})})]})}),Object(M.jsx)(wt.a,{})]},t)})),Qt=function(e){var t=e.faces,n=void 0===t?[]:t,a=e.video,i=e.onClick,o=void 0===i?function(){return null}:i,c=r.a.useState(),s=Object(H.a)(c,2),l=s[0],u=s[1];r.a.useEffect((function(){if(a&&n.length>0){var e=function(){return function(e){var t=e.faces,n=e.video,a=void 0===n?{}:n,r=e.setActiveTimespanIndex,i=e.activeTimespanIndex,o=a.currentTime,c=Number((void 0===o?0:o).toFixed(3)),s=t.findIndex((function(e){var t=e.start,n=e.end,a=Object(ae.c)(t),r=Object(ae.c)(n),i=Number(a.toSeconds().toFixed(3)),o=Number(r.toSeconds().toFixed(3));return c>=i&&c<o}));i!==s&&r(s)}({faces:n,video:a,activeTimespanIndex:l,setActiveTimespanIndex:u})};return a.addEventListener("timeupdate",e),function(){a.removeEventListener("timeupdate",e)}}}),[a,n]);var d=r.a.useCallback((function(e){a&&(a.currentTime=e,0===a.played.length&&a.play())}),[a]);return Object(M.jsx)(qt.a,{style:{height:500},totalCount:n.length,itemContent:function(e){var t=n[e],r=l===e;return Object(M.jsx)(Kt,{isActive:r,start:t.start,end:t.end,metadata:t.group,video:a,onSeek:d,onClick:o},t.start+t.end)}})},Xt=function(e){var t=e.onChange,n=e.confidenceText,a=void 0===n?"Confidence":n,i=r.a.useCallback(m()(t,500)),o=r.a.useState(50),c=Object(H.a)(o,2),s=c[0],l=c[1];return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(C.a,{variant:"caption",gutterBottom:!0,children:a}),Object(M.jsx)(Vt.a,{defaultValue:50,valueLabelDisplay:"auto",step:5,marks:!0,min:0,max:100,value:s,onChange:function(e,t){l(t),i(t/100)}})]})},Yt=Object(p.a)((function(e){var t=e.palette,n=e.spacing;return{faceList:{overflowY:"scroll",height:"100%",maxHeight:540,"&::-webkit-scrollbar":{WebkitAppearance:"none"},"&::-webkit-scrollbar:vertical":{width:11},"&::-webkit-scrollbar-thumb":{borderStyle:"solid",borderWidth:2,borderColor:t.common.white,backgroundColor:"rgba(0, 0, 0, 0.5)"}},searchInput:{flexGrow:1,paddingLeft:n(1)}}}))((function(e){var t=e.itemType,n=e.video,a=e.classes,i=e.onRefresh,o=be().showDialog,s=Ce().setNotification,u=r.a.useMemo((function(){return function(e){var t=e.itemType,n=t.metadata,a=t.thumbnails,r=(a=void 0===a?{}:a).uri,i=void 0===r?[]:r,o={includeTimespanAttributes:!0,includeGroupAttributes:!0,flatTimespan:!0,flatGroup:!0,groupAsList:!0,joinValue:","},c=(n||{}).timespan;return(void 0===c?[]:c).sort(ae.j).map((function(e){return Object(ae.h)(e,o)})).reduce((function(e,t){var n=t.start,a=i.find((function(e){return e.includes(n)}));return[].concat(Object(re.a)(e),[Object(b.a)(Object(b.a)({},t),{},{thumbnail:a})])}),[])}({itemType:t})}),[t]),d=r.a.useState(.5),j=Object(H.a)(d,2),m=j[0],h=j[1],p=r.a.useState(""),v=Object(H.a)(p,2),f=v[0],O=v[1],g=r.a.useMemo((function(){return function(e,t,n){return n.filter((function(n){var a=n.group,r=((void 0===a?[]:a).find((function(e){return e.name===_}))||{}).group,i=void 0===r?[]:r;return!!i.length&&i.some((function(n){var a=n.adu_av_value,r=n.adu_av_confidence;return a?a.toString().toLowerCase().includes(e.toLowerCase())&&r>=t:r>=t}))}))}(f,m,u)}),[f,m,u]);return Object(M.jsxs)(l.a,{children:[Object(M.jsxs)(T.a,{container:!0,alignItems:"center",children:[Object(M.jsx)(T.a,{item:!0,className:a.searchInput,children:Object(M.jsx)(c.t,{setFilterText:O,filterText:f})}),Object(M.jsx)(T.a,{item:!0,style:{flexGrow:.5,marginLeft:5,marginRight:5},children:Object(M.jsx)(Xt,{onChange:h})})]}),Object(M.jsx)("div",{className:a.faceList,children:Object(M.jsx)(Qt,{faces:g,video:n,onClick:function(e){var t={content:["metadata"],field:["__collection:parentId","itemId","".concat(E,":title")]},n={operator:{field:[{name:L,value:[{value:e}]}],operation:"OR"}};J.i.searchItem({itemSearchDocument:n,queryParams:t}).then((function(e){var t=e.data,n=(void 0===t?{}:t).item;n=void 0===n?[{}]:n;var a=Object(H.a)(n,1)[0].metadata;if(a){var r=Object(ae.f)(a,{flat:!0,arrayOnSingle:!1});o({Dialog:ze,allowCreate:!0,item:r}).then((function(){return s({open:!0,message:"Success!"})})).catch((function(e){var t=e.message;return t&&s({open:!0,message:t,severity:"error"})})).then(i)}}))}})})]})}));function $t(e){var t=e.itemId,n=e.videoEl,a=e.sampleRate,i=void 0===a?"PAL":a,o={content:["metadata"],group:[_,"adu_av_analyzedValue"],field:[F,N,U],sampleRate:i,"noauth-url":!0},c=r.a.useState(null),s=Object(H.a)(c,2),l=s[0],u=s[1],j=function e(){n.current&&!l?u(n.current.player.videoEl):null===l&&setTimeout(e,1e3)};return r.a.useEffect(j,[j]),Object(M.jsx)(d.e,{itemId:t,queryParams:o,children:Object(M.jsx)(Yt,{video:l,sampleRate:i})})}var Zt=function(e){e.onClick;var t=e.container,n=(e.classes,r.a.useState(!1)),a=Object(H.a)(n,2),i=a[0],c=a[1];return r.a.useEffect((function(){i||(t.innerHTML="",t.title="Capture face",t.style.overflow="hidden",c(!0))}),[i]),i?o.a.createPortal(Object(M.jsx)(l.a,{height:1,width:1,display:"flex",alignItems:"center",justifyContent:"center",children:Object(M.jsx)(y.a,{})}),t):null},en=Object(p.a)((function(e){e.palette;return{button:{zIndex:10,height:"44px !important",cursor:"pointer"}}}))((function(e){var t=e.screenshotRef,n=(e.onClick,e.classes),a=r.a.useState(null),i=Object(H.a)(a,2),o=i[0],c=i[1];return r.a.useEffect((function(){!function e(){t.current?c(document.querySelector(".vdt-screenshot-button")):setTimeout(e,250)}()}),[]),o?Object(M.jsx)(Zt,{container:o,classes:n}):null})),tn={content:["metadata","shape"],tag:"original",field:["title","mimeType","mediaType","created","user","originalFilename"],interval:"generic"},nn={content:["thumbnail","metadata","shape"],methodMetadata:[{key:"format",value:"SIGNED-AUTO"}],"noauth-url":!0,group:"stl_subtitle",field:"stl_text",sampleRate:"PAL"};function an(e){var t=e.itemId,n=e.startSeconds,a=e.endSeconds,i=e.EntityCommentComponent,o=void 0===i?c.h:i,j=e.isCinema,m=void 0!==j&&j,h=e.ItemHeaderProps,p=void 0===h?{}:h,v=e.onVideoEnd,f=Object(s.a)().t,O=Object(u.i)().itemId,g=be().showDialog,x=Ce().setNotification,y=Pe(),C=y.isConfigured,I=y.isLoading,S=t||O,w=new URLSearchParams(Object(u.h)().search),P=Number(w.get("t")||n),k=a,D=r.a.useRef(P),R=r.a.createRef();r.a.useEffect((function(){D.current&&R.current&&D.current!==P&&(D.current=P,R.current.player.videoEl.currentTime=P)}),[P,R]);var E=r.a.useState(m),A=Object(H.a)(E,2),L=A[0],_=A[1],F=[{label:f("Faces"),component:$t},{label:f("formats"),component:c.q,hideOnMount:!0}],N=r.a.useRef(!1),U=function(){return g({Dialog:rt,videoEl:R.current}).then((function(){return x({open:!0,message:"Import job started"})})).catch((function(e){var t=e.message;return t&&x({open:!0,message:t,severity:"error"})}))};return I?null:Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(l.a,{children:[Object(M.jsx)(en,{screenshotRef:N,onClick:U}),Object(M.jsxs)(T.a,{container:!0,justifyContent:"space-between",children:[Object(M.jsxs)(T.a,{item:!0,style:{width:L?"100%":"50%",marginLeft:L?8:0,marginRight:L?8:0,transition:"width 0.5s, margin 0.5s"},children:[Object(M.jsx)(d.e,{itemId:S,queryParams:tn,children:Object(M.jsx)(Bt,Object(b.a)(Object(b.a)({},p),{},{onCapture:U}))}),Object(M.jsx)(d.e,{itemId:S,queryParams:nn,children:Object(M.jsx)(c.n,{itemId:S,videoEl:R,subtitleGroup:nn.group,subtitleField:nn.field,onCinema:function(e){return _(e)},onScreenshot:U,ItemVideoPlayerProps:{onScreenshotSuccess:function(){return x({open:!0,message:"Screenshot Job Started"})},onScreenshotError:function(){return x({open:!0,message:"Error Starting Screenshot Job",severity:"error"})}},videoPlayerProps:Object(b.a)(Object(b.a)({},C&&{crossOrigin:"anonymous"}),{},{controlsBelowPlayer:!0,onReady:function(e){Number.isNaN(P)||(e.currentTime(P),e.poster("")),N.current=!0,v&&e.on("ended",v),v&&void 0!==k&&0!==k&&e.on("timeupdate",(function(){e.currentTime()>=k&&(e.pause(),v())}))}}),audioPlayerProps:{onReady:function(e){setTimeout((function(){e.play()}),500),v&&e.on("ended",v)}}})}),o&&Object(M.jsx)(o,{entityId:S,entity:"item",playerRef:R})]}),Object(M.jsx)(T.a,{xs:12,lg:L?12:6,item:!0,children:Object(M.jsx)(c.s,{tabs:F,itemId:S,videoEl:R,onError:function(e){return x({open:!0,message:e.message,severity:"error"})}})})]})]})})}var rn=n(119);function on(e){var t=e.setSearchFilter,n=e.initialSearchFilter,a=e.itemListType,i=void 0===a?{facet:[]}:a,o=e.filterFields,l=void 0===o?[]:o,u=Object(s.a)().t,d=l.map((function(e){var t=e.label,n=Object(le.a)(e,["label"]);return Object(b.a)(Object(b.a)({},n),{},{label:u(n.value,t)})})),j=r.a.useCallback(m()(t,400),[t]);return Object(M.jsx)(c.l,{itemListType:i,onChange:j,fields:d,initialSearchFilter:n,CardProps:{elevation:0,square:!0,variant:"outlined"},hideEmptyFilters:!0})}var cn=function(e){var t=e.thumbnail;return Object(M.jsx)("img",{style:{maxWidth:"60px",maxHeight:"40px",position:"absolute",top:0,bottom:0,margin:"auto"},alt:"Thumbnail",src:t})},sn=function(e){var t=e.avatar,n=e.innerProps,a=n.itemId,r=n.collectionId,i=n.itemType,o=void 0===i?{}:i,s=n.entityTimespan,l=(s=void 0===s?{}:s).start,u=void 0===l?0:l,d=Object(ae.c)(u),j=Object(ae.b)(o,u);return Object(M.jsx)("div",{children:Object(M.jsx)(h.b,{to:r?"/collection/".concat(r):"/item/".concat(a).concat(u?"?t=".concat(d.toSeconds()):""),children:Object(M.jsx)(c.z,{MimeTypeProps:{mimeType:r?"collection":t,thumbnail:j},MimeTypeComponent:j?cn:void 0})})})},ln=Object(p.a)({},{name:"CustomBinItem"})((function(e){var t=e.entityTimespan,n=r.a.useCallback((function(){return t?"".concat(Object(ae.c)(t.start).toSmpte()," - ").concat(Object(ae.c)(t.end).toSmpte()):void 0}),[t]),a=r.a.useCallback((function(e){var t=e.originalFilename,n=e.title,a=e.itemId,r=e.collectionId;return n||(t||(n||t||a||r))}),[]);return Object(M.jsx)(c.g,Object(b.a)({titleSelector:a,subheaderSelector:n,AvatarComponent:sn,imageSelector:function(){},ThumbnailComponent:null,ContentComponent:null,ActionsComponent:null},e))})),un=Object(d.l)(Object(p.a)({isDragging:{opacity:0}},{name:"CustomBinItemDraggable"}),c.Q)(ln);function dn(){var e=r.a.useContext(d.a),t=e.bin,n=e.allowDuplicates,a=e.setBin,i=e.setAllowDuplicates,o=e.onDrop,s=e.onSort,l=e.onDelete,j=e.onEmptyBin,m=Ce().setNotification,b=Object(u.g)(),h=r.a.useContext(c.e),p=h.DraggedComponent,v=h.setDraggedComponent;return r.a.useEffect((function(){return p||v(ln),function(){p&&v(null)}}),[p,v]),Object(M.jsx)(c.a,{bin:t,allowDuplicates:n,setBin:a,onDrop:o,onSort:s,onDelete:l,onEmptyBin:j,onAllowDuplicates:i,onAddToCollectionSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return m({open:!0,message:"Added to ".concat(e.join(",")),severity:"success"})},BinItemComponent:un,BinItemProps:{DraggedComponent:ln},CollectionCreateDialogProps:{onSuccess:function(e){var t=e.id;return b.push("/collection/".concat(t,"/"))}},BinProps:{elevation:0,square:!0,variant:"outlined"}})}var jn=[{label:"Created by",value:"created"},{label:"Title",value:"title"}];var mn=Object(p.a)((function(e){return{root:{height:"95%",width:"100%"},resultContainer:{height:"inherit",width:"inherit",display:"flex"},filterContainer:{minWidth:220,marginBottom:e.spacing(1)},leftResultContainer:{flexDirection:"column",marginRight:e.spacing(2)},rightResultContainer:{flexGrow:1,minWidth:"0%"},QueryBuilderContainer:{marginBottom:e.spacing(1)}}}))((function(e){var t=e.classes,n=e.children,a=e.setSearchText,i=e.isLoading,o=e.sortOptions,l=void 0===o?jn:o,u=e.onChangeSort,j=e.onChangePage,h=e.onChangeRowsPerPage,p=e.page,v=e.rowsPerPage,f=e.itemSearchDocument,O=e.layout,g=e.onChangeViewLayout,x=e.itemListType,y=e.setSearchFilter,C=void 0===y?function(){return null}:y,I=e.filterFields,S=e.withBin,w=void 0!==S&&S,P=e.BinProps,k=void 0===P?{}:P,D=e.onRefresh,R=r.a.useRef(null),E=r.a.useMemo((function(){return f.text&&f.text.length>0&&f.text[0].value||""}),[f.text]),A=f.sort,L=Object(s.a)().t,_=Object(d.r)(),F=_.suggestions,N=_.setAutocompleteText,U=r.a.useRef(m()(N,200)).current,B=i?p*v+1:0,V=r.a.useMemo((function(){return A&&A.length?{option:l.find((function(e){return e.value===A[0].field})),direction:A[0].order}:void 0}),[A,l]),q=r.a.useCallback((function(e){a(e),R.current.value=e}),[R,a]),W=x.suggestion,z=void 0===W?[]:W,G=x.hits,J=void 0===G?0:G,K=f.text;K=void 0===K?[]:K;var Q=Object(H.a)(K,1)[0],X=(Q=void 0===Q?{}:Q).value,Y=r.a.useState(),$=Object(H.a)(Y,1)[0],Z=r.a.useRef(m()(C,200)).current;return Object(M.jsxs)("div",{className:t.root,children:[Object(M.jsxs)(T.a,{container:!0,alignItems:"center",justifyContent:"flex-start",children:[Object(M.jsx)(T.a,{item:!0,sm:8,md:4,lg:6,children:Object(M.jsx)(T.a,{container:!0,wrap:"nowrap",children:Object(M.jsx)(c.E,{defaultValue:E,onSubmit:a,submitting:i,searchPlaceholder:L("Search content"),onChange:U,SuggestionsComponent:c.F,suggestions:F,inputRef:R,ButtonProps:{onClick:function(){if(R){var e=R.current.value;e&&X!==e?a(e):D()}},type:"button"}})})}),Object(M.jsx)(T.a,{item:!0,sm:4,md:8,lg:6,children:Object(M.jsxs)(T.a,{container:!0,alignItems:"center",justifyContent:"flex-end",children:[l&&Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(rn.a,{smDown:!0,children:Object(M.jsx)(c.I,{options:l.map((function(e){return{label:L(e.label),value:e.value}})),initialSort:V,onChange:u})})}),void 0!==p&&Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(rn.a,{smDown:!0,children:Object(M.jsx)(c.D,{onChangePage:j,onChangeRowsPerPage:h,count:J||B,page:p,rowsPerPage:v})})}),void 0!==O&&Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(c.v,{viewLayout:O,onChangeViewLayout:g})})]})})]}),Object(M.jsxs)("div",{className:t.resultContainer,children:[(w||I)&&Object(M.jsx)(rn.a,{smDown:!0,children:Object(M.jsxs)("div",{className:t.leftResultContainer,children:[I&&Object(M.jsx)("div",{className:t.filterContainer,children:Object(M.jsx)(on,{setSearchFilter:Z,initialSearchFilter:f.filter,isLoading:i,itemListType:x,filterFields:I},$)}),w&&Object(M.jsx)(dn,Object(b.a)({},k))]})}),Object(M.jsxs)("div",{className:t.rightResultContainer,children:[z&&z.length>0?Object(M.jsx)(c.J,{searchText:X,suggestions:z,onClick:q}):null,n]})]})]})})),bn=function(e){return function(t){var n=t.innerProps,a=void 0===n?{}:n,r=a.itemId,i=a.itemType,o=(i=void 0===i?{}:i).start,c="/item/".concat(r);return o&&"-INF"!==o&&(c+="?t=".concat(Object(ae.c)(o).toSeconds())),Object(M.jsx)(h.b,{to:c,children:Object(M.jsx)(e,Object(b.a)({},t))})}},hn=Object(d.l)(Object(p.a)({isDragging:{opacity:.5}},{name:"MediaCardHeaderDraggable"}),c.Q)(c.A),pn=function(e){var t=e.created;return t?Ae()(t).format("ll"):""},vn=function(e,t){var n=e.originalFilename,a=e.title,r=e.itemId,i=t.title;if("string"===typeof i){var o=i.indexOf(k),c=i.indexOf(D),s=i.slice(0,o),l=i.slice(c).replace(D,""),u=i.slice(o,c).replace(k,""),d=l.split(k).reduce((function(e,t){if(t.includes(D)){var n=t.split(D),a=Object(H.a)(n,2),r=a[0],i=a[1],o=[].concat(Object(re.a)(e),[Object(M.jsx)("strong",{children:r},r)]);return i&&o.push(Object(M.jsx)("em",{children:i},i)),o}return t?[].concat(Object(re.a)(e),[t]):e}),[]);if(u)return Object(M.jsxs)(M.Fragment,{children:[s,Object(M.jsx)("strong",{children:u}),d]})}return a||(n||r)},fn=bn(c.B);function On(e){var t=Object(v.a)((function(e){return e.breakpoints.up("sm")}));return Object(M.jsx)(M.Fragment,{children:Object(M.jsx)(c.m,Object(b.a)({ItemCardProps:{titleSelector:vn,subheaderSelector:pn,ThumbnailComponent:fn,HeaderComponent:hn,MenuComponent:null,ContentComponent:null,ActionsComponent:null,titleTypographyProps:{noWrap:!0,style:{width:220}},subheaderTypographyProps:{noWrap:!0,style:{width:220}}},GridContainerProps:{justifyContent:t?"flex-start":"space-evenly"},GridItemProps:{style:{paddingRight:8,paddingBottom:8}}},e))})}var gn=n(120),xn=function(e){var t=e.value;return t?Ae()(t).format("ll"):""},yn=function(e){var t=e.value;return t?function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60);return[t.toString().padStart(2,"0"),n.toString().padStart(2,"0"),a.toString().padStart(2,"0")].join(":")}(t):""},Cn=function(e){var t=e.innerProps,n=void 0===t?{}:t,a=n.itemType,r=void 0===a?{}:a,i=n.itemId,o=r.thumbnails,c=(void 0===o?{}:o).uri,s=void 0===c?[]:c,l=s[Math.floor(s.length/2)];return Object(M.jsx)(h.b,{to:"/item/".concat(i),children:l?Object(M.jsx)("img",{src:l,width:80,alt:""}):Object(M.jsx)("div",{style:{backgroundColor:"rgba(0,0,0,0.1)",width:80,height:45}})})},Tn=function(e){var t=e.value;return Object(M.jsx)(gn.a,{variant:"square",children:Object(M.jsx)(c.C,{mimeType:t})})},In=Object(c.Q)(c.o);function Sn(e){var t=e.itemListType,n=Object(s.a)().t;return Object(M.jsx)(c.r,{itemListType:t,RowComponent:In,wrapDragInDiv:!1,options:[{label:"",value:"mimeType",valueComponent:Tn},{label:"",valueComponent:Cn},{label:n("title"),value:"title"},{label:n("created"),value:"created",valueComponent:xn,hide:"xs"},{label:n("durationSeconds"),value:"durationSeconds",valueComponent:yn,hide:"xs"}]})}var wn=n(546),Pn=n(97),kn=n(234),Dn=n(128),Rn=n.n(Dn);var En=Object(p.a)((function(e){return{openSearch:{marginLeft:"auto"},formLabelContainer:{display:"flex"},popOver:{padding:e.spacing(1,2),width:"28vw",minHeight:"34vh"},searchInput:{width:250,padding:e.spacing(2),display:"block","& button":{display:"none"}},markAll:{padding:e.spacing(0,2)},filtersContainer:{display:"flex",alignContent:"baseline",flexWrap:"wrap",minHeight:"18vh",overflow:"auto",marginBottom:e.spacing(2),padding:e.spacing(2)},filter:{flex:"1 32%"},setSelection:{display:"block",marginLeft:"auto",margin:e.spacing(1)}}}),{name:"VdtSearchInFilters"})((function(e){var t=e.options,n=void 0===t?[]:t,a=e.onChange,i=e.label,o=e.classes,l=Object(s.a)().t,u=r.a.useState(),d=Object(H.a)(u,2),j=d[0],m=d[1],b=r.a.useState([]),h=Object(H.a)(b,2),p=h[0],v=h[1],O=r.a.useState(null),g=Object(H.a)(O,2),x=g[0],y=g[1],C=function(){y(null)};r.a.useEffect((function(){n&&m(n.slice(1))}),[n]);var T=function(e){var t=e.target.value;p.includes(t)?v((function(e){return e.filter((function(e){return e!==t}))})):v((function(e){return[].concat(Object(re.a)(e),[t])}))};return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("div",{className:Object(Wt.a)(o.formLabelContainer,"VdtCheckboxGroupField-formLabelContainer"),children:[Object(M.jsx)(Nt.a,{component:"legend",children:i}),Object(M.jsx)(f.a,{className:o.openSearch,size:"small",type:"submit",onClick:function(e){var t=e.currentTarget;y(t)},disableRipple:!0,children:Object(M.jsx)(Rn.a,{})})]}),Object(M.jsxs)(wn.a,{classes:{paper:o.popOver},open:Boolean(x),anchorEl:x,onClose:C,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:[Object(M.jsx)(c.L,{classes:{root:o.searchInput},onChange:function(e){var t=e.target.value,a=n.slice(1).filter((function(e){return e.value.toLowerCase().startsWith(t.toLowerCase())}));m(a)},label:i,helperText:null,InputProps:{endAdornment:Object(M.jsx)(Pn.a,{position:"end",children:Object(M.jsx)(Rn.a,{})})}}),Object(M.jsx)(jt.a,{className:o.markAll,label:l("markAll"),onChange:function(){p.length===j.length?v([]):v(j.map((function(e){return e.value})))},control:Object(M.jsx)(kn.a,{checked:p.length===n.slice(1).length})}),Object(M.jsx)(wt.a,{}),Object(M.jsx)("div",{className:o.filtersContainer,children:j&&j.map((function(e){return Object(M.jsx)(jt.a,{onChange:T,label:e.value,classes:{root:o.filter},control:Object(M.jsx)(kn.a,{name:e.value,value:e.value,checked:p.includes(e.value)})},e.value)}))}),Object(M.jsx)(f.a,{className:o.setSelection,variant:"contained",color:"primary",onClick:function(){p.length>0&&(a(p),v([]),C())},children:l("setSelection")})]})]})})),An=[{value:"title",component:c.L},{value:"mediaType",component:c.b,FormControlLabelComponent:c.k,FacetProps:{count:!0,exclude:["mediaType"]},parseOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e).map((function(t){return{value:t,label:"".concat(t," (").concat(e[t],")")}}));return t.unshift({value:"*",label:"Any Media Type "}),t},selectAllValue:"*",FormLabelComponent:En},{value:"originalVideoCodec",component:c.G,FacetProps:{count:!0}},{value:"originalAudioCodec",component:c.G,FacetProps:{count:!0}},{value:"originalHeight",showMarks:!1,component:c.H,isRange:!0,exclude:!0,FacetProps:{count:!0}},{value:"mimeType",label:"Mime Types",component:c.K,parseOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((function(e){return{value:e,label:e}}))},freeSolo:!0,FacetProps:{count:!0},AutocompleteProps:{multiple:!0}}],Ln={itemSearchDocument:{intervals:"all",highlight:{matchingOnly:!1,prefix:k,suffix:D,field:["title"]},facet:An.filter((function(e){var t=e.FacetProps;return!0===(void 0===t?{}:t).count})).map((function(e){var t=e.value,n=e.exclude,a=e.FacetProps;a=void 0===a?{}:a;var r=Object.assign({},a),i=n?{exclude:Array.isArray(n)?n:[t]}:{};return Object(b.a)(Object(b.a)({field:t,name:t},i),r)})),filter:[],suggestion:{maximumSuggestions:3,accuracy:.7}},queryParams:{field:["title","originalFilename","created","user","durationSeconds","mimeType","itemId"],content:["metadata","thumbnail"],"noauth-url":!0}},_n={operation:"NOT",field:[{name:R,value:[{value:!0}]}]},Fn="GRID_VIEW";function Nn(e){var t=e.isConfigured,n=Object(u.g)(),a=Object(d.y)({history:n,defaultState:Object(b.a)(Object(b.a)({},Ln),t&&{itemSearchDocument:Object(b.a)(Object(b.a)({},Ln.itemSearchDocument),{},{operator:_n})})}).queryInitialState,i=Object(d.A)(a),o=i.state,c=i.setSearchText,s=i.setItemSearchDocument,l=i.onChangeRowsPerPage,j=i.onChangePage,m=i.onChangeSort,h=i.setSearchFilter,p=o.matrixParams,v=o.queryParams,f=o.itemSearchDocument,O=o.page,g=o.rowsPerPage;Object(d.C)({history:n,state:o});var x,y=Object(d.B)({itemSearchDocument:f,queryParams:v,matrixParams:p}),C=y.itemListType,T=y.isLoading,I=y.onRefresh,S=r.a.useState("GRID_VIEW"),w=Object(H.a)(S,2),P=w[0],k=w[1];switch(P){case Fn:x=On;break;case"ROW_VIEW":x=Sn;break;default:x=On}return Object(M.jsx)(mn,{itemSearchDocument:f,itemListType:C,setSearchText:c,isLoading:T,onChangeSort:m,onChangePage:j,onChangeRowsPerPage:l,page:O,rowsPerPage:g,onChangeViewLayout:function(e,t){return k(t)},layout:P,setItemSearchDocument:s,setSearchFilter:h,filterFields:An,withBin:!0,onRefresh:I,children:Object(M.jsx)(x,{itemListType:C})})}var Un=function(){var e=Pe(),t=e.isConfigured;return e.isLoading?Object(M.jsx)(Fe.a,{}):Object(M.jsx)(Nn,{isConfigured:t})},Mn=n(376),Bn=n.n(Mn),Vn=n(116),qn=Object(p.a)((function(e){return{form:{"& > *":{marginTop:e.spacing(1.5),marginBottom:e.spacing(1.5)}}}}),{name:"VdtUploadForm"})((function(e){var t=e.classes,n=e.onChange,a=e.values,i=r.a.useMemo((function(){return!0===a[R]}),[a]);return Object(M.jsx)("div",{className:t.root,children:Object(M.jsxs)("div",{className:t.form,children:[!i&&Object(M.jsx)(K.a,{onChange:n("title"),value:a.title,label:"Title",variant:"outlined",required:!0,fullWidth:!0,InputLabelProps:{shrink:!0}}),i&&Object(M.jsx)(K.a,{onChange:n(E),value:a[E],label:"Face name",variant:"outlined",required:!0,fullWidth:!0,InputLabelProps:{shrink:!0}})]})})})),Wn=Object(p.a)((function(e){return{root:{},buttonContainer:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridGap:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},toggleButton:{paddingTop:e.spacing(3),paddingBottom:e.spacing(3),"&.large":{paddingTop:e.spacing(10),paddingBottom:e.spacing(10)},transition:e.transitions.create("padding",{duration:e.transitions.duration.shortest})}}}))((function(e){var t=e.classes,n=r.a.useContext(Te),a=n.useContentUploadFiles,i=n.useTrainingUploadFiles,o=n.uploadType,s=n.setUploadType,u=function(e){e!==o&&s(e)};return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(Vn.a,{in:!o,timeout:"auto",unmountOnExit:!0,children:Object(M.jsx)(l.a,{p:2,py:6,display:"flex",alignItems:"center",justifyContent:"center",children:Object(M.jsx)(C.a,{variant:"h4",children:"What are you uploading?"})})}),Object(M.jsxs)("div",{className:t.buttonContainer,children:[Object(M.jsx)(f.a,{className:Object(Wt.a)(t.toggleButton,{large:!o}),variant:"content"===o?"contained":"outlined",disableRipple:!0,onClick:function(){return u("content")},color:"primary",fullWidth:!0,children:"Content"}),Object(M.jsx)(f.a,{className:t.toggleButton,onClick:function(){return u("training")},disableRipple:!0,variant:"training"===o?"contained":"outlined",color:"primary",fullWidth:!0,children:"Faces"})]}),Object(M.jsx)(Vn.a,{in:!!o,timeout:"auto",unmountOnExit:!0,children:Object(M.jsxs)(Bn.a,{index:"content"===o?0:1,children:[Object(M.jsx)(c.N,{UploadButtonText:"Upload Content",allowUploadToCollection:!1,useUploadFiles:a,UploadEditorProps:{UploadFormComponent:qn,UploadFormProps:{trainingMaterial:"training"===o}}}),Object(M.jsx)(c.N,{UploadButtonText:"Upload Faces",UploadToCollectionButtonText:"Upload Faces to Collection",useUploadFiles:i,UploadEditorProps:{UploadFormComponent:qn,UploadFormProps:{trainingMaterial:"training"===o}}})]})})]})})),zn=n(35),Gn=n.n(zn),Hn=n(215),Jn=n(394),Kn=n(395),Qn=n(96);var Xn=function(e){var t=e.innerProps.collectionId,n=e.checked;return Object(M.jsx)(kn.a,{value:t,checked:n})},Yn=Object(d.l)(Object(p.a)((function(e){return{root:{flexGrow:1,maxWidth:"unset",cursor:"pointer",boxShadow:e.shadows[1],transition:"all 0.3s ease","& .MuiCardHeader-root":{paddingRight:8,transition:"all 0.3s ease"},"& .MuiCardHeader-action":{alignSelf:"unset"},"& .MuiIconButton-root":{transition:"all 0.3s ease"},"&:hover":{"& .MuiIconButton-root":{color:e.palette.secondary.main}}},canDrop:{borderColor:e.palette.primary.main},isOver:{"& .MuiCardHeader-root":{backgroundColor:e.palette.primary.main}}}})),c.R)(c.c),$n=function(e){var t=e.onClick,n=e.onDrop,a=e.checked,r=e.collectionType,i=r.id;return Object(M.jsx)(Yn,{CardProps:{onClick:function(){return t(i)}},onDrop:n,collectionType:r,collectionId:r.id,AvatarComponent:Xn,checked:a,subheaderSelector:function(e){var t=e.items;return"".concat(t," ").concat(1===Number(t)?"face":"faces")},titleTypographyProps:{},subheaderTypographyProps:{}})},Zn={queryParams:{field:["collectionId","title","__items_size:items"],content:"metadata"},rowsPerPage:5,itemSearchDocument:{}},ea=Object(d.l)(Object(p.a)((function(e){return{root:{borderWidth:2,borderStyle:"dashed",width:"100%",transition:"all 0.3s ease",borderColor:"transparent"},canDrop:{borderColor:e.palette.primary.main},isOver:{backgroundColor:e.palette.primary.main}}})),c.R)(f.a),ta=function(e){var t=e.collectionId,n=e.setCollectionId,a=e.onRefresh,r=be().showDialog,i=Pe().trainingId,o=Ce().setNotification,s=Object(d.A)(Object(b.a)(Object(b.a)({},Zn),{},{itemSearchDocument:Object(b.a)({},i&&{operator:{field:[{name:"collectionId",value:[{value:i}]}],operation:"NOT"}})})),u=s.state,j=(u=void 0===u?{}:u).itemSearchDocument,m=u.queryParams,h=u.matrixParams,p=u.rowsPerPage,v=s.setSearchText,O=s.onChangeRowsPerPage,g=function(e){var t=e.itemSearchDocument,n=e.queryParams,a=e.matrixParams,r=Object(d.q)(J.d.searchCollection),i=r.request,o=r.data,c=void 0===o?{}:o,s=r.isLoading,l=r.isError,u=function(){return i({itemSearchDocument:t,queryParams:n,matrixParams:a})};return Object(Qn.a)((function(){u()}),[t,n,a]),{collectionListType:c,isLoading:s,isError:l,onRefresh:u}}({itemSearchDocument:j,queryParams:m,matrixParams:h}),x=g.collectionListType,y=void 0===x?{}:x,I=g.onRefresh,S=g.isLoading,w=y.collection,P=void 0===w?[]:w,k=y.hits,D=void 0===k?0:k,R=function(){a(),I()},E=function(e){var a=t.filter((function(t){return t!==e}));a.length!==t.length?n(a):n([].concat(Object(re.a)(a),[e]))},A=function(){var e=Object(Hn.a)(Gn.a.mark((function e(t){var n,a,i,c,s;return Gn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.dragInfo,a=t.dropInfo,i=n.entityId,c=n.entityParentId,s=a.entityId){e.next=9;break}return e.next=6,r({Dialog:it});case 6:if(s=e.sent){e.next=9;break}return e.abrupt("return");case 9:se(i,s,c).then((function(){return o({open:!0,message:"Success!"})})).catch((function(e){return e.message&&o({open:!0,message:"Success!"})})).then(R);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(M.jsxs)(T.a,{container:!0,spacing:2,children:[Object(M.jsx)(T.a,{item:!0,xs:12,children:Object(M.jsx)(l.a,{height:50,display:"flex",alignItems:"center",children:Object(M.jsx)(c.E,{onSubmit:v,searchPlaceholder:"Search collections...",InputBaseProps:{style:{flexGrow:1}}})})}),Object(M.jsx)(T.a,{item:!0,xs:12,children:Object(M.jsx)(C.a,{variant:"h6",children:"Filter by collection"})}),P.map((function(e){return Object(M.jsx)(T.a,{item:!0,xs:12,children:Object(M.jsx)($n,{onDrop:A,onClick:E,checked:t.includes(e.id),collectionType:e})},e.id)})),P.length<D&&Object(M.jsx)(T.a,{item:!0,xs:12,children:Object(M.jsx)(f.a,{startIcon:S?Object(M.jsx)(Fe.a,{size:20}):Object(M.jsx)(Jn.a,{fontSize:"small"}),disabled:P.length===D,onClick:function(){return O({target:{value:p+5}})},children:"Load more..."})}),Object(M.jsx)(T.a,{item:!0,xs:12,children:Object(M.jsx)(ea,{startIcon:Object(M.jsx)(Kn.a,{fontSize:"small"}),onClick:function(){return r({Dialog:it}).then(R).catch((function(){return null}))},onDrop:A,children:"Create collection"})})]})},na=n(14),aa=n(626),ra=n(627),ia=n(628),oa=Object(d.l)(Object(p.a)((function(e){return{root:{boxShadow:e.shadows[1],transition:"box-shadow 0.3s ease",cursor:"grab","&:hover":{boxShadow:e.shadows[5]},"& .card-content":{backgroundColor:Object(na.c)(e.palette.background.paper,.1)},"& .card-thumbnail":{cursor:"grab !important"}},isDragging:{opacity:.3,cursor:"grabbing"}}})),c.Q)(c.y),ca=function(e){return Object(M.jsx)(oa,Object(b.a)({},e))},sa=function(e){var t=e.itemId,n=e.onOpen,a=e.onMerge,r=e.onDelete,i=e.onRename,o=e.onAddToCollection;return Object(M.jsxs)(Tt,{onOpen:n,size:"small",children:[Object(M.jsxs)(g.a,{component:h.b,to:"/training/".concat(t),children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(aa.a,{fontSize:"small"})}),Object(M.jsx)(St.a,{primary:"Go to face"})]}),Object(M.jsxs)(g.a,{onClick:i,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(ra.a,{fontSize:"small"})}),Object(M.jsx)(St.a,{primary:"Change name"})]}),Object(M.jsxs)(g.a,{onClick:o,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(ne.a,{fontSize:"small"})}),Object(M.jsx)(St.a,{primary:"Move to collection"})]}),Object(M.jsxs)(g.a,{onClick:a,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(ia.a,{fontSize:"small"})}),Object(M.jsx)(St.a,{primary:"Map to existing face"})]}),Object(M.jsx)(wt.a,{}),Object(M.jsxs)(g.a,{onClick:r,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(At.a,{fontSize:"small"})}),Object(M.jsx)(St.a,{primaryTypographyProps:{color:"error"},primary:"Delete face"})]})]})},la=function(e){var t=e.title,n=e.itemId,a=e.method,r=e.interactive,i=e.onOpen,o=e.onMerge,c=e.onDelete,s=e.onRename,u=e.onAddToCollection,d="INDEXED"===a,j="TRAINED"===a;return Object(M.jsxs)(l.a,{className:"card-content",display:"flex",flexDirection:"row",p:1,alignItems:"center",children:[Object(M.jsxs)(l.a,{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden",children:[Object(M.jsx)(C.a,{noWrap:!0,style:{flexGrow:1},variant:"subtitle1",children:t&&t}),d&&Object(M.jsx)(l.a,{color:"info.dark",children:Object(M.jsx)(C.a,{color:"inherit",variant:"button",children:"system trained"})}),j&&Object(M.jsx)(l.a,{color:"success.dark",children:Object(M.jsx)(C.a,{variant:"button",children:"user trained"})}),!j&&!d&&Object(M.jsx)(l.a,{color:"warning.dark",children:Object(M.jsx)(C.a,{variant:"button",children:"not trained"})})]}),Object(M.jsx)(l.a,{flexShrink:0,flexBasis:1,children:r&&Object(M.jsx)(sa,{itemId:n,onOpen:i,onMerge:o,onDelete:c,onRename:s,onAddToCollection:u})})]})},ua=function(e){var t=e.title,n=e.subheader,a=e.content,r=e.avatar,i=e.itemId,o=e.onOpen,c=e.onClick,s=e.onMerge,l=e.onDelete,u=e.onRename,d=e.onAddToCollection,j=e.interactive,m=void 0===j||j,h=Object(le.a)(e,["title","subheader","content","avatar","itemId","onOpen","onClick","onMerge","onDelete","onRename","onAddToCollection","interactive"]);return Object(M.jsx)(ca,Object(b.a)(Object(b.a)({},h),{},{CardProps:{style:{width:200},onClick:function(){return c({itemId:i,title:t,parentId:a,method:n})}},ThumbnailProps:{className:"card-thumbnail"},HeaderComponent:null,ActionsComponent:null,ContentComponent:la,ContentProps:{title:t,itemId:i,method:r,subheader:n,interactive:m,onOpen:function(){return o({itemId:i,parentId:a,title:t,method:r})},onMerge:s,onDelete:l,onRename:u,onAddToCollection:d},parentId:a,hideDefaultDraggedComponent:!1}))},da=n(636),ja=n(388),ma=n(632),ba=n(629),ha=n(630),pa=n(631),va={content:"shape",methodMetadata:[{key:"format",value:"SIGNED-AUTO"},{key:"contentDisposition",value:"attachment"}],"noauth-url":!0},fa=function(e){var t=e.onOpen,n=e.onClose,a=e.onMove,r=e.onDelete,i=e.onThumbnail;return Object(M.jsxs)(Tt,{size:"small",onOpen:t,onClose:n,style:{color:"#fff"},children:[Object(M.jsxs)(g.a,{onClick:a,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(aa.a,{})}),Object(M.jsx)(St.a,{primary:"Move resource"})]}),Object(M.jsxs)(g.a,{onClick:i,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(Et.a,{})}),Object(M.jsx)(St.a,{primary:"Use as thumbnail"})]}),Object(M.jsxs)(g.a,{onClick:r,children:[Object(M.jsx)(It.a,{children:Object(M.jsx)(At.a,{})}),Object(M.jsx)(St.a,{primary:"Delete resource"})]})]})},Oa=Object(p.a)((function(e){return{root:{zIndex:10,padding:e.spacing(1),height:"auto"},titleWrap:{margin:0}}}))(ba.a),ga=function(e){var t=e.resource,n=e.onMove,a=e.onDelete,i=t.uri,o=t.shapeId,s=t.metadata,l=r.a.useMemo((function(){if(!s)return"NOT TRAINED";var e=s.vcs_face_method;return"INDEXED"===e?"SYSTEM TRAINED":"TRAINED"===e?"USER TRAINED":"NOT TRAINED"}),[s]);return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(c.B,{image:i,height:200}),Object(M.jsx)(Oa,{title:l,actionIcon:Object(M.jsx)(fa,{shapeId:o,onMove:function(){return n(o)},onDelete:function(){return a(o)}})})]})},xa=Object(p.a)((function(e){var t=e.palette;return{tile:{backgroundColor:t.background.paper,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all .2s","&:hover":{backgroundColor:t.primary.main}}}}))(ha.a),ya=function(e){var t=e.itemType,n=e.onRefresh,a=e.cols,i=void 0===a?2:a,o=be().showDialog,c=Ce().setNotification,s=function(){return c({open:!0,message:"Success!"})},l=function(e){var t=e.message;return t&&c({open:!0,message:t,severity:"error"})},u=t.shape,d=void 0===u?[]:u,j=t.id,m=r.a.useMemo((function(){return d.map((function(e){return Object(b.a)(Object(b.a)({},function(e){if(!e)return{};var t={},n=e.id,a=e.metadata,r=Object(le.a)(e,["id","metadata"]),i=r.containerComponent,o=(i=void 0===i?{}:i).file,c=void 0===o?[]:o;if(c.length){var s=Object(H.a)(c,1)[0],l=s.id,u=s.storage;l&&(t.fileId=l),u&&(t.storageId=u)}if(a){var d=a.field,j=void 0===d?[]:d;j.length&&(t.metadata=Object(ae.e)(j))}return Object(b.a)(Object(b.a)(Object(b.a)({},Object(ae.g)(r,{flat:!0})),t),{},{shapeId:n})}(e)),{},{itemId:j})}))}),[d,j]),h=function(e){return o({title:"Delete resource",message:"Are you sure you want to delete this resource?",okText:"Yes, delete",noText:"No, cancel"}).then((function(){return function(e,t){return J.q.removeShape({itemId:e,shapeId:t})}(j,e).then(s).catch(l)})).catch(l).then(n)},p=function(e){return o({Dialog:st,itemId:j,shapeId:e}).then(s).catch(l).then(n)};return Object(M.jsxs)(pa.a,{cellHeight:200,cols:i,spacing:8,children:[m.map((function(e){return Object(M.jsx)(ha.a,{cols:1,children:Object(M.jsx)(ga,{resource:e,onMove:p,onDelete:h})},e.shapeId)})),Object(M.jsxs)(xa,{onClick:function(){return o({Dialog:Re,itemId:j}).then((function(){return c({open:!0,message:"Import job started"})})).catch(l)},cols:1,children:[Object(M.jsx)(Kn.a,{size:"large"}),Object(M.jsx)(C.a,{variant:"button",children:"Add new resource"})]})]})},Ca=function(e){var t=e.itemId,n=e.cols,a=void 0===n?2:n;return t?Object(M.jsx)(d.e,{itemId:t,queryParams:va,children:Object(M.jsx)(ya,{cols:a})}):null},Ta=n(64),Ia=n(38);var Sa=[{field:["adu_av_value","adu_av_valueId"],name:"adu_face_DeepVAKeyframeAnalyzer",label:"Recognized faces"}],wa=[{name:"adu_av_value",label:"Name"},{name:"adu_av_valueId",label:"ID"}],Pa=Object(p.a)((function(e){var t=e.spacing;return{root:{height:t(4),width:t(4)}}}))((function(e){var t=e.itemType,n=e.timespan,a=e.classes,r=Object(ae.b)(t,n.start||0),i=Object(ae.c)(n.start);return Object(M.jsx)(Gt.a,{title:i.toSmpte(),arrow:!0,placement:"right",children:Object(M.jsx)(gn.a,{classes:a,component:h.b,to:"/item/".concat(t.id,"?t=").concat(i.toSeconds()),variant:"rounded",src:r})})})),ka=function(e){var t=e.itemType,n=void 0===t?{}:t,a=r.a.useMemo((function(){return function(e){var t=Object(ae.f)(e.metadata,{flat:!0,arrayOnSingle:!1}).vcs_face_externalId;return t?{itemSearchDocument:{filter:[{name:"id_filter",operation:"OR",field:[{name:"adu_av_valueId",value:[{value:t}]}]}],intervals:"all",text:[{value:t}]},queryParams:{field:["originalFilename","durationSeconds","itemId","title","adu_value","adu_av_value","adu_av_valueId","adu_av_confidence"],content:["metadata","thumbnail"],"noauth-url":!0,interval:"all"}}:{queryParams:{number:0}}}(n)}),[n]),i=Object(d.A)(a).state,o=i.itemSearchDocument,s=void 0===o?{}:o,l=i.queryParams,u=i.matrixParams,j=Object(d.B)({itemSearchDocument:s,queryParams:l,matrixParams:u}).itemListType,m=(j=void 0===j?{}:j).item,b=void 0===m?[]:m;return Object(M.jsx)(Ta.a,{children:b.map((function(e,t){var n=e.metadata.timespan.filter((function(e){var t=e.start,n=e.end;return"-INF"===t&&"+INF"===n})),a=Object(H.a)(n,1)[0],r=Object(ae.h)(a,{flat:!0,arrayOnSingle:!1}).title;return Object(M.jsx)(Ia.a,{divider:t+1!==b.length,children:Object(M.jsx)(St.a,{disableTypography:!0,primary:Object(M.jsx)(C.a,{style:{marginBottom:30},variant:"h6",children:r}),secondary:Object(M.jsx)(c.j,{itemType:e,itemSearchDocument:s,GroupConfig:Sa,FieldLabelMap:wa,EventMarkerThumbnailComponent:Pa,EventContainerComponent:!1,EventComponent:!1,EventListComponent:!1,EventContentComponent:!1},e.id)})},e.id)}))})},Da={content:"metadata",field:"vcs_face_externalId"},Ra=function(e){var t=e.isLoading,n=Object(le.a)(e,["isLoading"]);return t?null:Object(M.jsx)(ka,Object(b.a)({},n))},Ea=function(e){var t=e.itemId;return Object(M.jsx)(d.e,{itemId:t,queryParams:Da,children:Object(M.jsx)(Ra,{})})},Aa=Object(d.l)(Object(p.a)((function(e){return{root:{flexShrink:0,"&.open":{width:400},"& > *":{transition:"all 0.3s ease"}},paper:{zIndex:e.zIndex.appBar-1,flexShrink:0,width:400,overflow:"auto"},canDrop:{"& > *":{border:"1px solid ".concat(e.palette.primary.main)}},isOver:{"& > *":{backgroundColor:e.palette.primary.main}}}})),c.R)(da.a),La=function(e){var t=e.itemId,n=Object(le.a)(e,["itemId"]),a=[{label:"images",component:Ca},{label:"appearances",component:Ea}];return Object(M.jsx)(c.s,Object(b.a)({tabs:a,itemId:t},n))},_a=function(e){var t=e.open,n=e.onDrop,a=e.onClose,i=e.item,o=void 0===i?{}:i,c=o.itemId,s=o.title,u=o.parentId,j=Object(d.q)(J.i.getItem),m=j.request,h=j.data,p=void 0===h?{}:h,v=j.isLoading;r.a.useEffect((function(){if(c){m({itemId:c,queryParams:{content:"shape",p:"shape.metadata.field[key=vcs_face_method]"}})}}),[c,m]);var f=r.a.useMemo((function(){var e=p.shape,t=void 0===e?[]:e;return!!t.length&&t.reduce((function(e,t){var n=t.metadata,a=(void 0===n?{}:n).field,r=((void 0===a?[]:a).find((function(e){return"vcs_face_method"===e.key}))||{}).value;return"TRAINED"!==r&&"INDEXED"!==r?Object(b.a)(Object(b.a)({},e),{},{needsTraining:!0}):e}),{needsTraining:!1})}),[p]).needsTraining;return Object(M.jsxs)(Aa,{className:t?"open":void 0,open:t,onClose:function(){return a(void 0)},anchor:"right",variant:"persistent",onDrop:n,children:[Object(M.jsx)(ja.a,{}),Object(M.jsxs)(l.a,{p:1,children:[Object(M.jsx)(Pt.a,{elevation:0,style:{backgroundColor:"inherit"},children:Object(M.jsx)(kt.a,{title:s,subheader:Object(M.jsxs)(M.Fragment,{children:[v&&Object(M.jsx)(Fe.a,{}),!v&&f&&Object(M.jsxs)(l.a,{mt:1,display:"flex",alignItems:"flex-start",flexGrow:1,color:"#f44336",children:[Object(M.jsx)(ma.a,{}),Object(M.jsx)(C.a,{style:{marginLeft:8},variant:"body2",children:"This resource needs to be trained."})]})]}),titleTypographyProps:{variant:"h4"},action:Object(M.jsx)(Ot.a,{onClick:function(){return a(void 0)},children:Object(M.jsx)(_t.a,{})})})}),c&&Object(M.jsx)(La,{itemId:c,parentId:u})]})]})},Fa=function(e){var t=e.checked;return Object(M.jsx)(kn.a,{checked:t})},Na=Object(p.a)((function(e){var t=e.shadows,n=e.palette,a=e.spacing;return{root:{marginBottom:a(2),cursor:"pointer",boxShadow:t[1],transition:"all 0.3s ease","& .MuiCardHeader-root":{paddingRight:a(1),transition:"all 0.3s ease"},"& .MuiCardHeader-action":{alignSelf:"unset"},"& .MuiIconButton-root":{transition:"all 0.3s ease"},"&:hover":{"& .MuiIconButton-root":{color:n.secondary.main}},"&:not(:last-child)":{marginRight:a(2)}}}}))((function(e){var t=e.onClick,n=Object(le.a)(e,["onClick"]);return Object(M.jsx)(c.y,Object(b.a)({ThumbnailComponent:null,ContentComponent:null,ActionsComponent:null,MenuComponent:null,AvatarComponent:Fa,CardProps:{onClick:t}},n))})),Ua="status_filter",Ma="vcs_face_method",Ba={name:"status_filter",operation:"AND",field:[{name:Ma,value:[{value:"TRAINED"}]}]},Va={name:"status_filter",operation:"AND",field:[{name:Ma,value:[{value:"INDEXED"}]}]},qa={name:"status_filter",operation:"NOT",field:[{name:Ma,value:[{value:"*"}]}]},Wa=function(e){var t=e.filter,n=void 0===t?{}:t,a=e.setFilter,i=r.a.useMemo((function(){var e=n.filter,t=(void 0===e?[]:e).find((function(e){return e.name===Ua}))||{},a=t.operation,r=t.field,i=void 0===r?[{}]:r;if("NOT"===a)return[!1,!1,!0];var o=Object(H.a)(i,1)[0].value;o=void 0===o?[{}]:o;var c=Object(H.a)(o,1)[0].value;return"TRAINED"===c?[!1,!0,!1]:"INDEXED"===c?[!0,!1,!1]:[!1,!1,!1]}),[n]),o=Object(H.a)(i,3),c=o[0],s=o[1],u=o[2];return Object(M.jsxs)(l.a,{display:"flex",flexDirection:"column",children:[Object(M.jsx)(C.a,{paragraph:!0,gutterBottom:!0,variant:"h6",children:"Filter by state"}),Object(M.jsxs)(l.a,{display:"flex",flexWrap:"wrap",children:[Object(M.jsx)(Na,{checked:s,onClick:function(){var e=n.filter,t=(void 0===e?[]:e).filter((function(e){return e.name!==Ua}));a(s?Object(b.a)(Object(b.a)({},n),{},{filter:t}):Object(b.a)(Object(b.a)({},n),{},{filter:[].concat(Object(re.a)(t),[Ba])}))},title:"User trained",subheader:"Display only faces trained manually"}),Object(M.jsx)(Na,{checked:c,onClick:function(){var e=n.filter,t=(void 0===e?[]:e).filter((function(e){return e.name!==Ua}));a(c?Object(b.a)(Object(b.a)({},n),{},{filter:t}):Object(b.a)(Object(b.a)({},n),{},{filter:[].concat(Object(re.a)(t),[Va])}))},title:"System trained",subheader:"Display only faces trained by the system"}),Object(M.jsx)(Na,{checked:u,onClick:function(){var e=n.filter,t=(void 0===e?[]:e).filter((function(e){return e.name!==Ua}));a(u?Object(b.a)(Object(b.a)({},n),{},{filter:t}):Object(b.a)(Object(b.a)({},n),{},{filter:[].concat(Object(re.a)(t),[qa])}))},title:"Not trained",subheader:"Display only faces not trained"})]})]})},za=["FAILED_TOTAL","ABORTED"],Ga=["FINISHED","FINISHED_WARNING"],Ha=function(e){var t=e.itemListType,n=e.onRefresh,a=e.state,i=be().showDialog,o=Ce().setNotification,s=a.state,u=(s=void 0===s?{}:s).page,j=s.searchText,b=void 0===j?"":j,h=s.rowsPerPage,p=s.itemSearchDocument,v=a.onChangePage,O=a.setSearchText,g=a.onChangeRowsPerPage,x=a.setItemSearchDocument,y=t.item,C=void 0===y?[]:y,I=t.hits,S=void 0===I?0:I,w=t.isLoading,P=Object(d.r)({field:E}),k=P.suggestions,D=P.setAutocompleteText,R=r.a.useRef(m()(D,200)).current;r.a.useEffect((function(){return R(b)}),[b,R]);var A=r.a.useCallback((function(){return o({open:!0,message:"Success!"})}),[o]),L=r.a.useCallback((function(e){if(e){var t=e.message;t&&o({open:!0,message:t,severity:"error"})}}),[o]),_=r.a.useCallback((function(e){var t=e.data,a=(t=void 0===t?{}:t).jobId,r=function(){var e=Object(Hn.a)(Gn.a.mark((function e(){var t,a,i;return Gn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.j.getJob({jobId:"VX-121"});case 2:t=e.sent,a=t.data,i=(void 0===a?{}:a).status,Ga.includes(i)?(A(),n()):za.includes(i)?L(new Error("Job failed")):setTimeout(r,250);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a?r():L(new Error("Failed to start job"))}),[n,A,L]),F=r.a.useState(void 0),N=Object(H.a)(F,2),U=N[0],B=N[1],V=r.a.useState(void 0),q=Object(H.a)(V,2),W=q[0],z=q[1],G=r.a.useState(!0),K=Object(H.a)(G,2),Q=K[0],X=K[1];return Object(M.jsxs)(l.a,{display:"flex",children:[Object(M.jsxs)(T.a,{container:!0,spacing:2,children:[Object(M.jsx)(T.a,{item:!0,xs:12,children:Object(M.jsxs)(l.a,{height:50,display:"flex",alignItems:"center",children:[Object(M.jsx)(c.E,{submitting:w,searchPlaceholder:"Search faces...",InputBaseProps:{style:{flexGrow:1}},value:b,onChange:O,SuggestionsComponent:c.F,SuggestionsProps:{suggestions:k}}),Object(M.jsxs)(f.a,{variant:"contained",color:"primary",style:{flexShrink:0,marginLeft:16},onClick:function(){return X(!Q)},children:[Q?"Hide":"Show"," filter"]}),Object(M.jsx)(c.D,{page:u,count:S,rowsPerPage:h,onChangePage:v,onChangeRowsPerPage:g,TablePaginationProps:{style:{flexShrink:0},labelRowsPerPage:"Items per page"}})]})}),Object(M.jsxs)(T.a,{item:!0,xs:12,children:[Object(M.jsx)(Vn.a,{in:Q,children:Object(M.jsx)(Wa,{filter:p,setFilter:x})}),Object(M.jsx)(c.m,{itemList:C,itemListType:t,GridContainerProps:{spacing:2},ItemCardProps:{MediaCardComponent:ua,onOpen:function(e){return B(e)},onClick:function(e){return z(e)},onMerge:function(){return i({Dialog:ze,item:U}).then(_).catch(L)},onDelete:function(){return i({title:"Delete resource",message:"Are you sure you would like to delete this resource?",okText:"Yes, delete item",noText:"No, cancel"}).then((function(){return(e=U.itemId,J.i.removeItem({itemId:e})).then(A).catch(L);var e})).catch(L).then(n)},onRename:function(){return i({Dialog:lt,item:U}).then(_).catch(L)},onAddToCollection:function(){return i({Dialog:De,item:U}).then(A).catch(L).then(n)},titleSelector:function(e){var t=e.title,n=e.filename;return t||n},contentSelector:function(e){return e.parentId},subheaderSelector:function(e){return e.created},avatarSelector:function(e){return e.method}}})]})]}),Object(M.jsx)(_a,{open:Boolean(W),item:W,onClose:z,onDrop:function(e){var t=e.dragInfo;return i({title:"Merge resources",message:"Are you sure you would like to merge these resources?",okText:"Yes, merge items",noText:"No, cancel"}).then((function(){return oe(t.entityId,W.itemId).then(_).catch(L)})).catch(L)}})]})},Ja={itemSearchDocument:{filter:[{name:"training_material",operation:"AND",field:[{name:R,value:[{value:!0}]}]}]},queryParams:{field:["".concat(E,":title"),"".concat(A,":method"),"created","originalFilename:filename","title:backupTitle","__collection:parentId"],content:["metadata","thumbnail"],methodMetadata:[{key:"format",value:"SIGNED-AUTO"}],"noauth-url":!0},rowsPerPage:10},Ka=function(){var e=r.a.useState([]),t=Object(H.a)(e,2),n=t[0],a=t[1],i=Object(d.A)(Ja),o=i.state,c=Object(le.a)(i,["state"]),s=o.itemSearchDocument,l=Object(d.B)(o),u=l.itemListType,j=void 0===u?{}:u,m=l.onRefresh;return r.a.useEffect((function(){var e=c.onChangePage,t=c.setSearchText,a=c.setItemSearchDocument,r=n.map((function(e){return{value:e}}));e({page:0}),t(""),r.length?a(Object(b.a)(Object(b.a)({},s),{},{operator:{field:[{name:"__parent_collection",value:r},{name:"__collection",value:r}],operation:"OR"}})):a(Object(b.a)(Object(b.a)({},s),{},{operator:void 0}))}),[n]),Object(M.jsxs)(T.a,{container:!0,spacing:2,alignItems:"flex-start",children:[Object(M.jsx)(T.a,{item:!0,xs:12,sm:12,md:4,lg:3,xl:2,children:Object(M.jsx)(ta,{collectionId:n,setCollectionId:a,onRefresh:m})}),Object(M.jsx)(T.a,{container:!0,item:!0,xs:12,sm:12,md:8,lg:9,xl:10,children:Object(M.jsx)(Ha,{itemListType:j,onRefresh:m,state:Object(b.a)({state:o},c)})})]})},Qa=function(){return Pe().isLoading?Object(M.jsx)(Fe.a,{}):Object(M.jsx)(Ka,{})},Xa=Object(p.a)({content:{overflow:"hidden"},avatar:{"& .MuiAvatar-root":{width:100,height:100}}})(kt.a),Ya=function(e){var t=e.itemType,n=void 0===t?{}:t,a=Object(s.a)().t,i=r.a.useMemo((function(){return Object(ae.f)(n.metadata,{flat:!0,arrayOnSingle:!1})}),[n]),o=i[E],c=i.user,u=i.created;return Object(M.jsx)(Xa,{title:o,style:{overflow:"hidden"},titleTypographyProps:{variant:"h3",noWrap:!0},subheader:Object(M.jsxs)(l.a,{display:"flex",alignItems:"center",children:[Object(M.jsxs)(C.a,{variant:"body1",children:[a("createdBy"),"\xa0"]}),Object(M.jsx)(C.a,{variant:"subtitle1",children:c}),Object(M.jsx)(C.a,{variant:"body1",children:"\xa0on\xa0"}),Object(M.jsx)(C.a,{variant:"subtitle1",children:u?Ae()(u).format("ll"):""})]}),avatar:Object(M.jsx)(gn.a,{variant:"rounded",alt:o})})},$a=function(e){var t=e.itemId,n=Object(le.a)(e,["itemId"]),a=[{label:"images",component:Ca,cols:4},{label:"appearances",component:Ea}];return Object(M.jsx)(c.s,Object(b.a)({tabs:a,itemId:t},n))},Za=function(){var e=Object(u.i)().itemId;return Object(M.jsxs)(T.a,{container:!0,children:[Object(M.jsx)(T.a,{item:!0,xs:12,sm:6,children:Object(M.jsx)(d.e,{itemId:e,queryParams:{content:["metadata"],interval:"generic"},children:Object(M.jsx)(Ya,{})})}),Object(M.jsx)(T.a,{item:!0,xs:12,sm:6,children:Object(M.jsx)($a,{itemId:e})})]})},er=m()((function(e){window.localStorage.setItem("bin",JSON.stringify(e))}),500),tr=JSON.parse(window.localStorage.getItem("bin")||JSON.stringify([]));var nr=function(e){var t=e.username,n=e.onLogout,a=e.serverUrl,r=e.onLogin;return Object(M.jsxs)(d.c,{providers:[we,{provider:pe,resourceType:"vidinet"},ye,{provider:d.b,initialState:tr,onChange:er},d.h,c.f,{provider:Ie,uploadProps:{onUploadFile:et,chunkedUploadProps:{chunkSize:2e8,minChunkSize:1e7,maxConcurrentTransfers:10,minFileSize:1e8,maxConcurrentFileTransfers:1}}},me],children:[Object(M.jsxs)(l.a,{height:"100vh",children:[Object(M.jsx)(ft,{userName:t,onLogout:n,serverUrl:a,onLogin:r}),Object(M.jsx)(l.a,{mb:7.5,p:2,children:Object(M.jsxs)(u.d,{children:[Object(M.jsx)(u.b,{path:"/import",children:Object(M.jsx)(Wn,{})}),Object(M.jsx)(u.b,{path:"/item/:itemId",children:Object(M.jsx)(an,{})}),Object(M.jsx)(u.b,{path:"/item/",children:Object(M.jsx)(Un,{})}),Object(M.jsx)(u.b,{path:"/training/:itemId",children:Object(M.jsx)(Za,{})}),Object(M.jsx)(u.b,{path:"/training/",children:Object(M.jsx)(Qa,{})}),Object(M.jsx)(u.a,{from:"/",push:!0,to:"/item/"})]})})]}),Object(M.jsx)(c.u,{})]})},ar=n(633),rr=new URLSearchParams(window.location.search).get("to")||"";function ir(e){var t=e.onLogin,n=e.userName,a=e.serverUrl,r=void 0===a?rr:a,i=e.onBack,o=e.AppTitleComponent,l=Object(s.a)().t;return Object(M.jsxs)(ar.a,{maxWidth:"sm",children:[Object(M.jsx)("div",{style:{height:"30vh"}}),Object(M.jsxs)(T.a,{container:!0,justifyContent:"space-between",alignItems:"center",direction:"row",style:{width:"100%"},children:[Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(o,{subheader:r})}),i&&Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(f.a,{onClick:i,size:"small",variant:"outlined",children:l("Back To Server List")})})]}),Object(M.jsx)(c.w,{onSubmit:t,FormProps:{initialValues:{userName:n,serverUrl:r}},FormFieldsProps:{UrlFieldComponent:r?null:void 0,RememberMeFieldComponent:null},FormButtonsProps:{SubmitButtonProps:{variant:"outlined",color:"primary"}}})]})}var or=n(107),cr=n(92),sr=n(63),lr=n.n(sr),ur=n(163),dr=n.n(ur),jr=n(377),mr=n.n(jr),br=n(378),hr=n.n(br),pr=n(153);function vr(e){var t=e.onClickServer,n=e.serverList,a=void 0===n?[]:n,i=e.onAddServer,o=e.onRemoveServer,c=e.AppTitleComponent,s=r.a.useState(),l=Object(H.a)(s,2),u=l[0],d=l[1],j=r.a.useState(0===a.length),m=Object(H.a)(j,2),b=m[0],h=m[1],p=r.a.useState(),v=Object(H.a)(p,2),f=v[0],O=v[1],g=r.a.useState(""),x=Object(H.a)(g,2),y=x[0],C=x[1],I=function(e){e&&e.preventDefault&&e.preventDefault();var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Not a URL",n=new RegExp(/https?:\/\/[-a-zA-Z0-9@:%._+~#=]{2,256}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/gi);return e.match(n)?void 0:t}(y);t?O(t):(i(y),h(!1),C(""),O())};r.a.useEffect((function(){Promise.all(a.map((function(e){return new Promise((function(t){return J.n.getSelfTest({baseURL:e}).then((function(){return t(!0)})).catch((function(){return t(!1)}))}))}))).then((function(e){return d(e)}))}),[a]);return Object(M.jsxs)(ar.a,{maxWidth:"sm",children:[Object(M.jsx)("div",{style:{height:"30vh"}}),Object(M.jsxs)(T.a,{container:!0,justifyContent:"space-between",direction:"row",style:{width:"100%"},children:[c&&Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(c,{})}),Object(M.jsx)(T.a,{item:!0,children:Object(M.jsx)(jt.a,{control:Object(M.jsx)(or.a,{checked:b,onChange:function(e){return h(e.target.checked)}}),label:"Edit"})})]}),Object(M.jsxs)(Ta.a,{component:"nav",children:[b&&Object(M.jsx)(Ia.a,{children:Object(M.jsx)("form",{onSubmit:I,style:{width:"100%"},children:Object(M.jsx)(K.a,{value:y,onChange:function(e){C(e.target.value)},label:"Add Server",variant:"outlined",fullWidth:!0,error:void 0!==f,helperText:f,InputProps:{endAdornment:Object(M.jsx)(Pn.a,{position:"end",children:Object(M.jsx)(Ot.a,{onClick:I,children:Object(M.jsx)(dr.a,{})})})}})})}),a.map((function(e,n){return Object(M.jsxs)(Ia.a,{button:!b,onClick:b?void 0:function(){return t(e)},children:[Object(M.jsx)(St.a,{primary:e}),Object(M.jsx)(cr.a,{children:b?Object(M.jsx)(Ot.a,{edge:"end",onClick:function(){return o(e)},children:Object(M.jsx)(lr.a,{})}):Array.isArray(u)&&(!0===u[n]?Object(M.jsx)(mr.a,{style:{color:pr.a[500]}}):Object(M.jsx)(hr.a,{color:"error"}))})]},e)}))]})]})}var fr=n(379),Or=n(380),gr=n(114),xr=n(386),yr=n(384),Cr=n(175),Tr=n(634),Ir="https://vidispine.github.io/face-training-theme",Sr=Ir;if(Sr.startsWith("http")){var wr=new URL(Sr);Sr=wr.pathname}var Pr={maxAge:604800,path:Sr,sameSite:"strict"},kr="VIDISPINE-SERVERS",Dr="VIDISPINE-TOKEN",Rr=function(e){Object(xr.a)(n,e);var t=Object(yr.a)(n);function n(e){var a;Object(fr.a)(this,n),(a=t.call(this,e)).onChangeServer=a.onChangeServer.bind(Object(gr.a)(a)),a.onAddServer=a.onAddServer.bind(Object(gr.a)(a)),a.onRemoveServer=a.onRemoveServer.bind(Object(gr.a)(a)),a.onUpdateCookie=a.onUpdateCookie.bind(Object(gr.a)(a)),a.onLogin=a.onLogin.bind(Object(gr.a)(a)),a.onLogout=a.onLogout.bind(Object(gr.a)(a));var r=e.cookies,i=r.get(kr),o=r.get(Dr),c=function(e){if(e){var t=atob(e);return JSON.parse(t)}}(i),s=window.location.pathname,l=function(e){var t=Object(Cr.a)("/:basename/server/:serverUrl/:any*").exec(e);if(t||(t=Object(Cr.a)("/:basename/server/:serverUrl",[],{strict:!0}).exec(e)),t||(t=Object(Cr.a)("/server/:serverUrl/:any*").exec(e)),t)try{var n=t[2];return decodeURIComponent(n)}catch(a){if(a instanceof URIError)return;throw a}}(s);if(a.state={servers:c,token:o},e.serverUrl&&l!==e.serverUrl){var u={serverUrl:e.serverUrl,userName:""};a.state.apiServer=u,a.state.servers=[u]}else if(l)if(c){var d=c.find((function(e){return e.serverUrl===l}));d?a.state.apiServer=d:(a.state.apiServer={serverUrl:l},a.state.token=void 0)}else a.state.apiServer={serverUrl:l},a.state.token=void 0;else!function(e){var t=Object(Cr.a)("/:basename/server/(.*)",[],{strict:!0}).exec(e);if(t&&t[2])try{var n=new URL(t[2]).origin;if(!n)return;var a=encodeURIComponent(n),r=e.replace(n,a);window.history.pushState({},document.title,r),window.location.reload()}catch(i){}}(s);return a}return Object(Or.a)(n,[{key:"onChangeServer",value:function(e){var t=Sr;e&&(t="".concat(Ir.replace(/\/+$/,""),"/server/").concat(encodeURIComponent(e),"/")),window.history.pushState({},document.title,t);var n=this.state.servers,a=(void 0===n?[]:n).find((function(t){return t.serverUrl===e}))||{};a.hasToken?window.location.reload():this.setState({apiServer:a})}},{key:"onAddServer",value:function(e){var t=e.replace(/^(.+?)\/*?$/,"$1"),n=this.state.servers,a=void 0===n?[]:n,r=[{serverUrl:t}].concat(Object(re.a)(a));this.setState({servers:r}),this.onUpdateCookie(r)}},{key:"onRemoveServer",value:function(e){var t=this.state.servers,n=(void 0===t?[]:t).filter((function(t){return t.serverUrl!==e}));this.setState({servers:n}),this.onUpdateCookie(n)}},{key:"onUpdateCookie",value:function(e){var t=this.props.cookies,n=function(e){if(e){var t=JSON.stringify(e);return btoa(t)}}(e);t.set(kr,n,Pr)}},{key:"onLogin",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return null},r=e.userName,i=e.password,o=e.serverUrl;a(),r&&i&&o?J.w.getToken({userName:r,queryParams:{seconds:2592e3,autoRefresh:"true"},headers:{password:i,username:r},baseURL:o}).then((function(e){var t=e.data,a={serverUrl:o,userName:r,hasToken:!0},i=n.props,c=i.cookies,s=i.serverUrl;c.set(Dr,t,Object(b.a)(Object(b.a)({},Pr),{},{path:s?"/":"".concat(Sr.replace(/\/+$/,""),"/server/").concat(encodeURIComponent(o))}));var l=n.state.servers,u=void 0===l?[]:l,d=Object(re.a)(u),j=d.findIndex((function(e){return e.serverUrl===o}));if(j>-1){var m=d[j];d[j]=Object(b.a)(Object(b.a)({},m),a)}else d.push(a);n.onUpdateCookie(d),n.setState({token:t,servers:d,apiServer:a})})).catch((function(){J.n.getSelfTest({baseURL:o}).then((function(){return a({password:"Incorrect Username/Password"})})).catch((function(){return a({password:"Offline or CORS not configured"})}))})):a({password:"Form Incomplete"})}},{key:"onLogout",value:function(){var e=this.props,t=e.cookies,n=e.serverUrl,a=this.state,r=a.apiServer,i=a.servers,o=void 0===i?[]:i,c=r.serverUrl;t.remove(Dr,Object(b.a)(Object(b.a)({},Pr),{},{path:n?"/":"".concat(Sr.replace(/\/+$/,""),"/server/").concat(encodeURIComponent(c))})),this.setState({token:void 0});var s=Object(re.a)(o),l=s.findIndex((function(e){return e.serverUrl===c}));if(l>-1){var u=s[l];s[l]=Object(b.a)(Object(b.a)({},u),{},{hasToken:!1}),this.setState({servers:s}),this.onUpdateCookie(s)}this.onUpdateCookie(s)}},{key:"render",value:function(){var e=this.props.serverUrl,t=this.state,n=t.apiServer,a=void 0===n?{}:n,r=t.servers,i=void 0===r?[]:r,o=t.token,c=a.userName,s=a.serverUrl,l=i.map((function(e){return e.serverUrl})),u=this.props,j=u.AppComponent,m=u.AppProps,p=void 0===m?{}:m,v=u.LoginComponent,f=u.LoginProps,O=void 0===f?{}:f,g=u.AppTitleComponent,x=e?"/":"".concat(Sr.replace(/\/+$/,""),"/server/").concat(encodeURIComponent(s));return s?Object(M.jsx)(M.Fragment,{children:o?Object(M.jsx)(h.a,{basename:x,children:Object(M.jsx)(d.k,{token:o,username:c,serverUrl:s,children:Object(M.jsx)(j,Object(b.a)({onLogout:this.onLogout,AppTitleComponent:g,onLogin:this.onLogin},p))})}):Object(M.jsx)(v,Object(b.a)({AppTitleComponent:g,userName:c,serverUrl:s,onBack:e?void 0:this.onChangeServer,onLogin:this.onLogin},O))}):Object(M.jsx)(vr,{AppTitleComponent:g,onClickServer:this.onChangeServer,onAddServer:this.onAddServer,onRemoveServer:this.onRemoveServer,serverList:l})}}]),n}(r.a.Component),Er=Object(Tr.a)(Rr),Ar=n(177),Lr=n(263),_r=n.n(Lr),Fr=(n(294),_r.a[500]),Nr=_r.a[300],Ur={useNextVariants:!0,htmlFontSize:18,fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',subtitle2:{fontWeight:600}},Mr={MuiButton:{root:{borderRadius:0}},MuiTableCell:{head:{fontWeight:600}},VdtQueryEntry:{queryGroup:{borderRadius:0}}},Br={light:Object(Ar.a)({typography:Ur,overrides:Mr,palette:{type:"light",primary:{main:Fr},background:{default:"#f7f7f7"}}}),dark:Object(Ar.a)({typography:Ur,overrides:Mr,palette:{type:"dark",primary:{main:Nr},background:{default:"rgb(40, 44, 52)",paper:"rgb(32, 35, 42)"}}})},Vr=n(381),qr={en:"enUS",sv:"svSE",de:"deDE"};function Wr(e){var t=e.t,n=e.lng;return Object(b.a)({VdtSort:{caption:t("sortBy")},VdtSearchInput:{searchPlaceholder:t("search")},VdtFilterCard:{headerText:t("filter")},VdtCollectionCreateDialog:{title:t("newCollection"),createText:t("create"),closeText:t("cancel"),collectionNameText:t("name")},VdtBinListMenu:{emptyBinText:t("emptyBin"),createCollectionText:t("createCollection"),allowDuplicatesText:t("allowDuplicates"),removeText:t("removeAfterDrag")},VdtBinList:{title:t("bin")},VdtItemMetadataTab:{editingLabel:function(e){return t(e?"cancel":"edit")}},VdtCollectionMetadataTab:{editingLabel:function(e){return t(e?"cancel":"edit")}},VdtJobList:{jobColumnLabels:{jobId:t("jobId"),type:t("type"),state:t("state"),user:t("createdBy"),startTime:t("started"),priority:t("priority"),status:t("status"),started:t("started"),finished:t("finished"),yesterday:t("yesterday"),thisWeek:t("thisWeek"),allTime:t("allTime")}},VdtJobTable:{jobColumnLabels:{type:t("type"),started:t("started")}},VdtJobRow:{retryText:t("retry"),deleteText:t("delete"),startedText:t("started"),finishedText:t("finished")},VdtSearchInputFieldSelect:{fieldPlaceHolder:t("field"),queryPlaceHolder:t("query")},VdtSelectedFile:{fileText:t("file")},VdtSelectedStorage:{storageText:t("storage")},VdtStorageTree:{storageText:t("storage"),loadMoreText:t("loadMore")},VdtFieldGroupDesigner:{onSavedText:t("hasBeenSaved"),selectedGroupText:t("selectedGroup"),availableFieldsText:t("availableFields"),currentFieldsText:t("currentFields"),editorText:t("editor")},VdtFieldGroupEditor:{nameText:t("name"),typeText:t("type"),deleteText:t("delete"),revertText:t("revert"),updateText:t("update"),deleteFieldText:t("deleteField"),deleteConfirmationText:t("deleteConfirmation")},VdtUserAvatarButton:{signOutText:t("signOut"),toggleThemeText:t("toggleTheme")},VdtUpload:{UploadToCollectionButtonText:t("Upload To Collection"),UploadButtonDisabledText:t("uploading"),UploadButtonText:t("upload"),DragActiveText:t("dropFilesHere"),DragInactiveText:t("dropOrClick"),UploadCollectionPickerProps:{titleText:t("Upload To Collection"),submitText:t("upload")}},VdtSourceSelection:{previewSourceText:t("previewSource")},VdtItemFieldGroupTab:{editingLabel:function(e){return t(e?"cancel":"edit")},metadataGroupText:t("metadataGroup")},VdtItemMetadataForm:{saveText:t("save")},VdtItemTimespanFilter:{searchText:t("search")},VdtItemTimespanSelection:{eventTypeText:t("eventType")},VdtConfidenceSlider:{confidenceText:t("confidence")},VdtItemTimespanEdit:{sameAsStartText:t("sameAsStart"),laterThanEndText:t("laterThanEnd")},VdtItemTimespanForm:{startText:t("start"),endText:t("end"),textText:t("text"),requiredText:t("required"),saveText:t("save"),deleteText:t("delete"),cancelText:t("cancel")},VdtUrlField:{label:t("vsApiServer")},VdtUsernameField:{label:t("username"),requiredText:t("required")},VdtPasswordField:{label:t("password"),requiredText:t("required")},VdtRememberMeField:{label:t("rememberMe")},VdtLoginFormButtons:{loginText:t("login")},VdtQueryOperator:{operatorText:t("operator"),fieldText:t("field")},VdtQueryField:{fieldText:t("field"),valueText:t("value")},VdtAddToCollectionDialog:{titleText:t("addToCollection"),submitText:t("addToCollection")},VdtCollectionSearchPicker:{idLabelText:t("id"),titleLabelText:t("title"),ownerLabelText:t("owner"),searchPlaceholder:t("searchCollections")},VdtEntityAccessEdit:{permissionText:t("permission"),recipientTypeText:t("recipientType"),grantAccessText:t("grantAccess"),userText:t("user"),groupText:t("group"),searchText:t("search")},VdtCollectionAccessTab:{toggleAddLabelText:function(e){return t(e?"cancel":"grantAccess")}},VdtItemAccessTab:{toggleAddLabelText:function(e){return t(e?"cancel":"grantAccess")}},VdtSavedSearchRow:{editTitleText:t("edit"),shareText:t("share"),listAccessText:t("access"),deleteText:t("delete")},VdtSavedSearchList:{searchPlaceholderText:t("findSearches")},VdtSaveSearchForm:{nameText:t("newSavedSearch"),saveText:t("save")},VdtCreateCollection:{collectionNameText:t("newCollection")},VdtSpellCheck:{didYouMeanText:t("didYouMean")},VdtItemMetadataFieldRow:{labelText:function(e,n){return t(e,n)}}},Vr[qr[n]].props)}function zr(){var e=Object(s.a)().t;return document.title=P||e("appTitle"),Object(M.jsx)(c.M,{themes:Br,props:Wr({t:e,lng:G.language}),children:Object(M.jsx)(Er,{AppComponent:nr,LoginComponent:ir,AppTitleComponent:B,serverUrl:w})})}o.a.render(Object(M.jsx)(a.Suspense,{fallback:null,children:Object(M.jsx)(zr,{})}),document.getElementById("root"))}},[[541,1,2]]]);